<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SDQ Python Program Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2b3a4a;       /* Deep navy blue - primary color */
            --secondary: #4ecdc4;     /* Teal - secondary color */
            --accent: #ff6b6b;       /* Coral - for accents and warnings */
            --light: #f7f9fc;        /* Very light gray - for backgrounds */
            --dark: #2b3a4a;          /* Dark text */
            --success: #48bb78;       /* Green - for success messages */
            --warning: #ed8936;       /* Orange - for warnings */
            --info: #4299e1;         /* Blue - for info boxes */
            --error: #f56565;        /* Red - for errors */
            --sidebar-bg: #2b3a4a;    /* Dark navy for sidebar */
            --card-bg: #ffffff;       /* White for cards */
            --text-light: #718096;    /* Light gray text */
            --highlight: #e6fffa;     /* Mint highlight */
            --sidebar-highlight: #4ecdc4; /* Teal highlight for sidebar */
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background-color: var(--light);
            color: var(--dark);
        }
        
        .dashboard {
            display: flex;
            min-height: 100vh;
        }
        
        .sidebar {
            width: 280px;
            background: var(--sidebar-bg);
            color: white;
            padding: 20px 0;
            box-shadow: 4px 0 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .logo {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .logo h1 {
            font-size: 22px;
            font-weight: 600;
            color: white;
            background: linear-gradient(90deg, #4ecdc4, #a5ffd6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 0.5px;
        }
        
        .menu-category {
            margin-bottom: 15px;
        }
        
        .menu-title {
            padding: 12px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
            border-left: 3px solid transparent;
            font-weight: 500;
            color: rgba(255,255,255,0.9);
        }
        
        .menu-title:hover {
            background-color: rgba(255,255,255,0.08);
            color: white;
        }
        
        .menu-title.active {
            background-color: rgba(78, 205, 196, 0.15);
            border-left: 3px solid var(--sidebar-highlight);
            color: white;
        }
        
        .submenu {
            display: none;
            background-color: rgba(0,0,0,0.1);
            padding: 5px 0;
        }
        
        .submenu.show {
            display: block;
        }
        
        .submenu-item {
            padding: 10px 20px 10px 40px;
            cursor: pointer;
            transition: all 0.3s;
            color: rgba(255,255,255,0.8);
            font-size: 14px;
        }
        
        .submenu-item:hover {
            background-color: rgba(78, 205, 196, 0.2);
            color: white;
        }
        
        .main-content {
            flex: 1;
            padding: 30px;
            background-color: var(--light);
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        
        .header h2 {
            color: var(--primary);
            font-size: 24px;
            font-weight: 600;
            background: linear-gradient(90deg, #2b3a4a, #4a5568);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            background-color: rgba(78, 205, 196, 0.1);
            padding: 8px 15px;
            border-radius: 20px;
            transition: all 0.3s;
        }
        
        .user-profile:hover {
            background-color: rgba(78, 205, 196, 0.2);
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4ecdc4, #a5ffd6);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .generator-container {
            background-color: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.03);
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        
        .generator-container:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.05);
        }
        
        .generator-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        
        .generator-header h3 {
            color: var(--primary);
            font-weight: 600;
            font-size: 20px;
            background: linear-gradient(90deg, #2b3a4a, #4a5568);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
            font-size: 14px;
        }
        
        .form-group label.required:after {
            content: " *";
            color: var(--error);
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
            background-color: var(--light);
        }
        
        .form-control:focus {
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(78, 205, 196, 0.2);
            outline: none;
            background-color: white;
        }
        
        .form-control.error {
            border-color: var(--error);
        }
        
        .error-message {
            color: var(--error);
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4ecdc4, #88dac8);
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #3dbeb5, #77cab8);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(78, 205, 196, 0.3);
        }
        
        .btn-secondary {
            background-color: #a0aec0;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #718096;
            transform: translateY(-2px);
        }
        
        .btn-clear {
            background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
            color: white;
            margin-left: 10px;
        }
        
        .btn-clear:hover {
            background: linear-gradient(135deg, #e55a5a, #ff7d7d);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(255, 107, 107, 0.3);
        }
        
        .btn:disabled {
            background-color: #cbd5e0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .code-container {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            margin-top: 20px;
            overflow-x: auto;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            color: #e2e8f0;
        }
        
        .copy-btn {
            background: linear-gradient(135deg, #4ecdc4, #88dac8);
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }
        
        .copy-btn:hover {
            background: linear-gradient(135deg, #3dbeb5, #77cab8);
            transform: translateY(-2px);
        }
        
        .copy-btn.copied {
            background: linear-gradient(135deg, #48bb78, #68d391);
        }
        
        .code-container pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .code-keyword {
            color: #63b3ed;
        }
        
        .code-function {
            color: #f6ad55;
        }
        
        .code-string {
            color: #68d391;
        }
        
        .code-comment {
            color: #a0aec0;
            font-style: italic;
        }
        
        .code-number {
            color: #f687b3;
        }
        
        .hidden {
            display: none;
        }
        
        .status-card {
            background: linear-gradient(135deg, #4ecdc4, #88dac8);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            height: 100%;
        }
        
        .status-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .status-card h3 {
            font-size: 18px;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .status-card p {
            font-size: 14px;
            opacity: 0.9;
            line-height: 1.5;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        /* New styles for the info boxes */
        .info-boxes {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .info-box {
            flex: 1;
            background-color: var(--light);
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid var(--info);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        
        .info-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .info-box h4 {
            color: var(--info);
            margin-bottom: 10px;
            font-size: 16px;
            font-weight: 600;
        }
        
        .info-box p {
            color: var(--dark);
            font-size: 14px;
            line-height: 1.5;
        }
        
        /* Dropdown styles */
        .select-wrapper {
            position: relative;
            margin-bottom: 15px;
        }
        
        .select-wrapper select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            appearance: none;
            background-color: var(--light);
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 1em;
            transition: all 0.3s;
        }
        
        .select-wrapper select:focus {
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(78, 205, 196, 0.2);
            outline: none;
            background-color: white;
        }
        
        .button-group {
            display: flex;
            align-items: center;
        }
        
        .form-hint {
            font-size: 12px;
            color: var(--text-light);
            margin-top: 5px;
            font-style: italic;
        }
        
        /* Home page styles */
        .welcome-container {
            background-color: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.03);
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(0,0,0,0.05);
        }
        
        .welcome-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        
        .welcome-header h3 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 24px;
            font-weight: 600;
            background: linear-gradient(90deg, #2b3a4a, #4a5568);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .welcome-header p {
            color: var(--text-light);
            font-size: 15px;
        }
        
        .tip-card {
            background-color: var(--light);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 4px solid var(--success);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        
        .tip-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .tip-card h4 {
            color: var(--success);
            margin-bottom: 10px;
            font-size: 16px;
            font-weight: 600;
        }
        
        .tip-card p {
            color: var(--dark);
            line-height: 1.6;
            margin-bottom: 8px;
        }
        
        .tip-card p:last-child {
            margin-bottom: 0;
        }
        
        .getting-started {
            margin-top: 30px;
            background-color: var(--light);
            border-radius: 10px;
            padding: 25px;
            border-left: 4px solid var(--info);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .getting-started h4 {
            color: var(--info);
            margin-bottom: 15px;
            font-size: 16px;
            font-weight: 600;
        }
        
        .getting-started ol {
            padding-left: 20px;
            margin-top: 10px;
        }
        
        .getting-started li {
            margin-bottom: 10px;
            line-height: 1.6;
            color: var(--dark);
        }
        
        /* Search box styles */
        .search-container {
            margin-bottom: 30px;
            position: relative;
        }
        
        .search-box {
            width: 100%;
            padding: 12px 20px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            padding-left: 45px;
        }
        
        .search-box:focus {
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(78, 205, 196, 0.2);
            outline: none;
        }
        
        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
        }
        
        .search-results {
            position: absolute;
            width: 100%;
            max-height: 300px;
            overflow-y: auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            z-index: 100;
            display: none;
            margin-top: 5px;
        }
        
        .search-results.show {
            display: block;
        }
        
        .search-result-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .search-result-item:hover {
            background-color: #f8fafc;
        }
        
        .search-result-item h4 {
            color: var(--primary);
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .search-result-item p {
            color: var(--text-light);
            font-size: 12px;
            margin: 0;
        }
        
        .search-result-category {
            font-size: 12px;
            color: var(--secondary);
            font-weight: 600;
            margin-top: 5px;
        }
        
        /* Animation for status cards */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .status-card:nth-child(1) {
            animation: fadeIn 0.6s ease forwards;
        }
        
        .status-card:nth-child(2) {
            animation: fadeIn 0.8s ease forwards;
        }
        
        .status-card:nth-child(3) {
            animation: fadeIn 1s ease forwards;
        }
        
        .status-card:nth-child(4) {
            animation: fadeIn 1.2s ease forwards;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .dashboard {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                padding: 15px;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .info-boxes {
                flex-direction: column;
            }
            
            .grid {
                grid-template-columns: 1fr;
            }
            
            .search-results {
                max-height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="sidebar">
            <div class="logo" onclick="showHomePage()">
                <h1>SDQ Program Generator</h1>
            </div>
            
            <div class="menu-category">
                <div class="menu-title" onclick="toggleSubmenu('missing-check')">
                    <span>Missing Check</span>
                    <span>‚ñº</span>
                </div>
                <div class="submenu" id="missing-check">
                    <div class="submenu-item" onclick="showGenerator('dov-anchor')">Date of visit + Enrollment failure Check</div>
                    <div class="submenu-item" onclick="showGenerator('sae-trigger')">Enrollment failure Check</div>
                    <div class="submenu-item" onclick="showGenerator('form-missing')">Drug accountability Check</div>
                    <div class="submenu-item" onclick="showGenerator('ds-missing')">DS Dataset Missing Check</div>
                </div>
            </div>
            
            <div class="menu-category">
                <div class="menu-title" onclick="toggleSubmenu('date-comparison')">
                    <span>Date Comparison</span>
                    <span>‚ñº</span>
                </div>
                <div class="submenu" id="date-comparison">
                    <div class="submenu-item" onclick="showGenerator('dates-not-equal')">Dates are Not Equal Check</div>
                    <div class="submenu-item" onclick="showGenerator('greater-than')">Primary is after Secondary Check</div>
                    <div class="submenu-item" onclick="showGenerator('less-than')">Primary is before Secondary Check</div>
                </div>
            </div>
            
            <div class="menu-category">
                <div class="menu-title" onclick="toggleSubmenu('global-check')">
                    <span>Global Check</span>
                    <span>‚ñº</span>
                </div>
                <div class="submenu" id="global-check">
                    <div class="submenu-item" onclick="showGenerator('si-unit')">SI unit exist in global lab Check</div>
                    <div class="submenu-item" onclick="showGenerator('us-unit')">US unit exist in global lab Check</div>
                    <div class="submenu-item" onclick="showGenerator('si-numeric')">Reported unit is present and result is numeric (SI Unit Check)</div>
                    <div class="submenu-item" onclick="showGenerator('us-numeric')">Reported unit is present and result is numeric (US Unit Check)</div>
                </div>
            </div>
            
            <!-- New Common Checks Category -->
            <div class="menu-category">
                <div class="menu-title" onclick="toggleSubmenu('common-check')">
                    <span>Common Checks</span>
                    <span>‚ñº</span>
                </div>
                <div class="submenu" id="common-check">
                    <div class="submenu-item" onclick="showGenerator('common-check-1')">Duplicate Entries Check</div>
                    <div class="submenu-item" onclick="showGenerator('common-check-2')">Lower level/Dictionary version/Preferred term Check</div>
                    <div class="submenu-item" onclick="showGenerator('common-check-3')">Common Check 3</div>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="header">
                <h2>Python Program Generator</h2>
                <div class="user-profile">
                    <div class="user-avatar">G</div>
                    <span>Guest</span>
                </div>
            </div>
            
            <!-- Welcome/Home Page Content -->
            <div class="welcome-container" id="welcome-page">
                <div class="welcome-header">
                    <h3>Welcome to SDQ Program Generator</h3>
                    <p>Generate Python programs for clinical data validation with ease</p>
                </div>
                
                <!-- Search Box -->
                <div class="search-container">
                    <div class="search-icon">üîç</div>
                    <input type="text" class="search-box" id="search-box" placeholder="Search for checks..." autocomplete="off">
                    <div class="search-results" id="search-results"></div>
                </div>
                
                <div class="grid">
                    <div class="status-card">
                        <h3>Missing Checks</h3>
                        <p>Generate programs for data completeness validation</p>
                    </div>
                    <div class="status-card" style="background: linear-gradient(135deg, #ff6b6b, #ff8e8e);">
                        <h3>Date Comparisons</h3>
                        <p>Create date validation rules and checks</p>
                    </div>
                    <div class="status-card" style="background: linear-gradient(135deg, #48bb78, #68d391);">
                        <h3>Global Checks</h3>
                        <p>Standard validation rules for all studies</p>
                    </div>
                    <div class="status-card" style="background: linear-gradient(135deg, #a78bfa, #8b5cf6);">
                        <h3>Common Checks</h3>
                        <p>Frequently used validation checks</p>
                    </div>
                </div>
                
                <div class="tip-card">
                    <h4>Quick Tips</h4>
                    <p>1. Use the sidebar to navigate between different program generators</p>
                    <p>2. Fill in the required fields for each generator</p>
                    <p>3. Click "Generate Python Code" to create your program</p>
                    <p>4. Copy the generated code with the "Copy to Clipboard" button</p>
                </div>
                
                <div class="tip-card">
                    <h4>Best Practices</h4>
                    <p>‚Ä¢ Always validate your generated code before deploying to production</p>
                    <p>‚Ä¢ Test with sample data to ensure the validation logic works as expected</p>
                    <p>‚Ä¢ Document your validation rules for future reference</p>
                </div>
                
                <div class="getting-started">
                    <h4>Getting Started</h4>
                    <ol>
                        <li>Select a generator from the sidebar menu</li>
                        <li>Fill in the required parameters for your validation rule</li>
                        <li>Click "Generate Python Code" to create your program</li>
                        <li>Copy the code and integrate it into your validation pipeline</li>
                        <li>Test the validation with sample data to verify it works as expected</li>
                    </ol>
                </div>
            </div>
            
            <!-- DOV Anchor Check Generator -->
            <div class="generator-container hidden" id="dov-anchor-generator">
                <div class="generator-header">
                    <h3>Date of Visit, Enrollment failure, Form missed Check</h3>
                </div>
                
                <!-- New info boxes -->
                <div class="info-boxes">
                    <div class="info-box">
                        <h4>Description</h4>
                        <p>If 'Is the subject an enrollment failure?' is 'No' and Event Date is present, eCRF should be completed</p>
                    </div>
                    <div class="info-box">
                        <h4>Query Text</h4>
                        <p>Event Date is present, but eCRF is missing, Please update</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="dov-rule-name" class="required">Rule Name</label>
                    <input type="text" id="dov-rule-name" class="form-control" placeholder="Enter rule name" required>
                    <div class="error-message" id="dov-rule-name-error">Rule name is required</div>
                </div>
                <div class="form-group">
                    <label for="dov-domain1" class="required">Primary Domain</label>
                    <input type="text" id="dov-domain1" class="form-control" placeholder="Enter primary domain" value="DOV" required>
                    <div class="error-message" id="dov-domain1-error">Primary domain is required</div>
                </div>
                <div class="form-group">
                    <label for="dov-domain2" class="required">Related Domain</label>
                    <input type="text" id="dov-domain2" class="form-control" placeholder="Enter related domain" required>
                    <div class="error-message" id="dov-domain2-error">Related domain is required</div>
                </div>
                <div class="form-group">
                    <label for="dov-domain3" class="required">Additional Domain</label>
                    <input type="text" id="dov-domain3" class="form-control" placeholder="Enter additional domain" value="TRIGGER" required>
                    <div class="error-message" id="dov-domain3-error">Additional domain is required</div>
                </div>
                <div class="form-group">
                    <label for="dov-form1" class="required">Primary Form List</label>
                    <input type="text" id="dov-form1" class="form-control" placeholder="Enter primary form list" required>
                    <div class="error-message" id="dov-form1-error">Primary form list is required</div>
                </div>
                <div class="form-group">
                    <label for="dov-visit1" class="required">Applicable visits</label>
                    <input type="text" id="dov-visit1" class="form-control" placeholder="Enter visits" required>
                    <div class="error-message" id="dov-visit1-error">Visits are required</div>
                    <div class="form-hint">Enter comma separated visits if multiple (e.g., VISIT1,VISIT2,VISIT3)</div>
                </div>
                <div class="form-group">
                    <label for="dov-form2" class="required">Related Form List</label>
                    <input type="text" id="dov-form2" class="form-control" placeholder="Enter related form" required>
                    <div class="error-message" id="dov-form2-error">Related form list is required</div>
                    <div class="form-hint">Enter comma separated forms if multiple (e.g., FORM1,FORM2,FORM3)</div>
                </div>
                <div class="form-group">
                    <label for="dov-form3" class="required">Additional Form List</label>
                    <input type="text" id="dov-form3" class="form-control" placeholder="Enter additional form list" required>
                    <div class="error-message" id="dov-form3-error">Additional form list is required</div>
                </div>
                <div class="form-group">
                    <label for="dov-filter-col" class="required">Filter Column</label>
                    <input type="text" id="dov-filter-col" class="form-control" placeholder="Enter filter column name" value="DCMDATE" required>
                    <div class="error-message" id="dov-filter-col-error">Filter column is required</div>
                </div>
                <div class="form-group">
                    <label for="dov-filter-func" class="required">Filter Function Name</label>
                    <div class="select-wrapper">
                        <select id="dov-filter-func" class="form-control" onchange="handleFilterFuncChange()" required>
                            <option value="udf_glbl_filter_by_form_visit">udf_glbl_filter_by_form_visit</option>
                            <option value="udf_glbl_filter_by_formid_visitid">udf_glbl_filter_by_formid_visitid</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="dov-filter-func-custom" class="form-control hidden" placeholder="Enter custom filter function name">
                    <div class="error-message" id="dov-filter-func-error">Filter function is required</div>
                </div>
                <div class="form-group">
                    <label for="dov-query-func" class="required">Query Text Function</label>
                    <div class="select-wrapper">
                        <select id="dov-query-func" class="form-control" onchange="handleQueryFuncChange()" required>
                            <option value="udf_glbl_update_querytext">udf_glbl_update_querytext</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="dov-query-func-custom" class="form-control hidden" placeholder="Enter custom query text function">
                    <div class="error-message" id="dov-query-func-error">Query text function is required</div>
                </div>
                <div class="form-group">
                    <label for="dov-enroll-col" class="required">Enrollment Column</label>
                    <input type="text" id="dov-enroll-col" class="form-control" placeholder="Enter enrollment column name" value="_V_ENROLLFAILYN" required>
                    <div class="error-message" id="dov-enroll-col-error">Enrollment column is required</div>
                </div>
                <div class="form-group">
                    <label for="dov-enroll-val" class="required">Enrollment Value</label>
                    <input type="text" id="dov-enroll-val" class="form-control" placeholder="Enter enrollment value" value="N" required>
                    <div class="error-message" id="dov-enroll-val-error">Enrollment value is required</div>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="validateAndGenerateDovCode()">Generate Python Code</button>
                    <button class="btn btn-clear" onclick="clearDovInputs()">Clear Inputs</button>
                </div>
                
                <div class="code-container hidden" id="dov-code-output">
                    <div class="code-header">
                        <span>Generated Python Code:</span>
                        <button class="copy-btn" onclick="copyToClipboard('dov-code-content')">Copy to Clipboard</button>
                    </div>
                    <pre id="dov-code-content"></pre>
                </div>
            </div>

            <!-- DS Missing Check Generator -->
            <div class="generator-container hidden" id="ds-missing-generator">
                <div class="generator-header">
                    <h3>DS Dataset Missing Check</h3>
                </div>
                
                <!-- New info boxes -->
                <div class="info-boxes">
                    <div class="info-box">
                        <h4>Description</h4>
                        <p>If Primary reason for ending study is completed on eCRF, then, eCRF should be completed.</p>
                    </div>
                    <div class="info-box">
                        <h4>Query Text</h4>
                        <p>Primary reason for ending study is completed on eCRF, but eCRF is not completed. Please review and update.</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="ds-rule-name" class="required">Rule Name</label>
                    <input type="text" id="ds-rule-name" class="form-control" placeholder="Enter rule name" required>
                    <div class="error-message" id="ds-rule-name-error">Rule name is required</div>
                </div>
                <div class="form-group">
                    <label for="ds-domain1" class="required">Primary Domain</label>
                    <input type="text" id="ds-domain1" class="form-control" placeholder="Enter primary domain" value="DS" required>
                    <div class="error-message" id="ds-domain1-error">Primary domain is required</div>
                </div>
                <div class="form-group">
                    <label for="ds-form1" class="required">Primary Form List</label>
                    <input type="text" id="ds-form1" class="form-control" placeholder="Enter primary form list" required>
                    <div class="error-message" id="ds-form1-error">Primary form list is required</div>
                </div>
                <div class="form-group">
                    <label for="ds-form2" class="required">Related Form List</label>
                    <input type="text" id="ds-form2" class="form-control" placeholder="Enter related form list" required>
                    <div class="error-message" id="ds-form2-error">Related form list is required</div>
                </div>
                <div class="form-group">
                    <label for="ds-filter-func" class="required">Filter Function Name</label>
                    <div class="select-wrapper">
                        <select id="ds-filter-func" class="form-control" onchange="handleDsFilterFuncChange()" required>
                            <option value="udf_glbl_filter_by_form_visit">udf_glbl_filter_by_form_visit</option>
                            <option value="udf_glbl_filter_by_formid_visitid">udf_glbl_filter_by_formid_visitid</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="ds-filter-func-custom" class="form-control hidden" placeholder="Enter custom filter function name">
                    <div class="error-message" id="ds-filter-func-error">Filter function is required</div>
                </div>
                <div class="form-group">
                    <label for="ds-query-func" class="required">Query Text Function</label>
                    <div class="select-wrapper">
                        <select id="ds-query-func" class="form-control" onchange="handleDsQueryFuncChange()" required>
                            <option value="udf_glbl_update_querytext">udf_glbl_update_querytext</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="ds-query-func-custom" class="form-control hidden" placeholder="Enter custom query text function">
                    <div class="error-message" id="ds-query-func-error">Query text function is required</div>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="validateAndGenerateDsCode()">Generate Python Code</button>
                    <button class="btn btn-clear" onclick="clearDsInputs()">Clear Inputs</button>
                </div>
                
                <div class="code-container hidden" id="ds-code-output">
                    <div class="code-header">
                        <span>Generated Python Code:</span>
                        <button class="copy-btn" onclick="copyToClipboard('ds-code-content')">Copy to Clipboard</button>
                    </div>
                    <pre id="ds-code-content"></pre>
                </div>
            </div>
            
            <!-- Dates Not Equal Check Generator -->
            <div class="generator-container hidden" id="dates-not-equal-generator">
                <div class="generator-header">
                    <h3>Dates are Not Equal Check</h3>
                </div>
                
                <!-- New info boxes -->
                <div class="info-boxes">
                    <div class="info-box">
                        <h4>Description</h4>
                        <p>Date should be same as corresponding date</p>
                    </div>
                    <div class="info-box">
                        <h4>Query Text</h4>
                        <p>Date [primary date] is not equal to corresponding date [secondary date] </p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="date-ne-rule-name" class="required">Rule Name</label>
                    <input type="text" id="date-ne-rule-name" class="form-control" placeholder="Enter rule name" required>
                    <div class="error-message" id="date-ne-rule-name-error">Rule name is required</div>
                </div>
                <div class="form-group">
                    <label for="date-ne-domain1" class="required">Primary Domain</label>
                    <input type="text" id="date-ne-domain1" class="form-control" placeholder="Enter primary domain" required>
                    <div class="error-message" id="date-ne-domain1-error">Primary domain is required</div>
                </div>
                <div class="form-group">
                    <label for="date-ne-domain2" class="required">Related Domain</label>
                    <input type="text" id="date-ne-domain2" class="form-control" placeholder="Enter related domain" required>
                    <div class="error-message" id="date-ne-domain2-error">Related domain is required</div>
                </div>
                <div class="form-group">
                    <label for="date-ne-prim-form" class="required">Primary Form List</label>
                    <input type="text" id="date-ne-prim-form" class="form-control" placeholder="Enter primary form list" required>
                    <div class="error-message" id="date-ne-prim-form-error">Primary form list is required</div>
                </div>
                <div class="form-group">
                    <label for="date-ne-prim-visit" class="required">Primary Visit List</label>
                    <input type="text" id="date-ne-prim-visit" class="form-control" placeholder="Enter primary visit list" required>
                    <div class="error-message" id="date-ne-prim-visit-error">Primary visit list is required</div>
                    <div class="form-hint">Enter comma separated visits if multiple (e.g., VISIT1,VISIT2,VISIT3)</div>
                </div>
                <div class="form-group">
                    <label for="date-ne-rel-form" class="required">Related Form List</label>
                    <input type="text" id="date-ne-rel-form" class="form-control" placeholder="Enter related form list" required>
                    <div class="error-message" id="date-ne-rel-form-error">Related form list is required</div>
                </div>
                <div class="form-group">
                    <label for="date-ne-prim-date-col" class="required">Primary Date Column</label>
                    <input type="text" id="date-ne-prim-date-col" class="form-control" placeholder="Enter primary date column" required>
                    <div class="error-message" id="date-ne-prim-date-col-error">Primary date column is required</div>
                </div>
                <div class="form-group">
                    <label for="date-ne-rel-date-col" class="required">Related Date Column</label>
                    <input type="text" id="date-ne-rel-date-col" class="form-control" placeholder="Enter related date column" required>
                    <div class="error-message" id="date-ne-rel-date-col-error">Related date column is required</div>
                </div>
                <div class="form-group">
                    <label for="date-ne-filter-func" class="required">Filter Function Name</label>
                    <div class="select-wrapper">
                        <select id="date-ne-filter-func" class="form-control" onchange="handleDateNeFilterFuncChange()" required>
                            <option value="udf_glbl_filter_by_form_visit">udf_glbl_filter_by_form_visit</option>
                            <option value="udf_glbl_filter_by_formid_visitid">udf_glbl_filter_by_formid_visitid</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="date-ne-filter-func-custom" class="form-control hidden" placeholder="Enter custom filter function name">
                    <div class="error-message" id="date-ne-filter-func-error">Filter function is required</div>
                </div>
                <div class="form-group">
                    <label for="date-ne-query-func" class="required">Query Text Function</label>
                    <div class="select-wrapper">
                        <select id="date-ne-query-func" class="form-control" onchange="handleDateNeQueryFuncChange()" required>
                            <option value="udf_glbl_update_querytext">udf_glbl_update_querytext</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="date-ne-query-func-custom" class="form-control hidden" placeholder="Enter custom query text function">
                    <div class="error-message" id="date-ne-query-func-error">Query text function is required</div>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="validateAndGenerateDateNeCode()">Generate Python Code</button>
                    <button class="btn btn-clear" onclick="clearDateNeInputs()">Clear Inputs</button>
                </div>
                
                <div class="code-container hidden" id="date-ne-code-output">
                    <div class="code-header">
                        <span>Generated Python Code:</span>
                        <button class="copy-btn" onclick="copyToClipboard('date-ne-code-content')">Copy to Clipboard</button>
                    </div>
                    <pre id="date-ne-code-content"></pre>
                </div>
            </div>
            
            <!-- SAE Trigger Check Generator -->
            <div class="generator-container hidden" id="sae-trigger-generator">
                <div class="generator-header">
                    <h3>Enrollment failure with Form missed Check</h3>
                </div>
                
                <!-- New info boxes -->
                <div class="info-boxes">
                    <div class="info-box">
                        <h4>Description</h4>
                        <p>If 'Is the subject an enrollment failure?' is 'No', eCRF should be completed</p>
                    </div>
                    <div class="info-box">
                        <h4>Query Text</h4>
                        <p>Data is required for eCRF</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="sae-rule-name" class="required">Rule Name</label>
                    <input type="text" id="sae-rule-name" class="form-control" placeholder="Enter rule name" required>
                    <div class="error-message" id="sae-rule-name-error">Rule name is required</div>
                </div>
                <div class="form-group">
                    <label for="sae-domain1" class="required">Primary Domain</label>
                    <input type="text" id="sae-domain1" class="form-control" placeholder="Enter primary domain" required>
                    <div class="error-message" id="sae-domain1-error">Primary domain is required</div>
                </div>
                <div class="form-group">
                    <label for="sae-domain2" class="required">Related Domain</label>
                    <input type="text" id="sae-domain2" class="form-control" placeholder="Enter related domain" required>
                    <div class="error-message" id="sae-domain2-error">Related domain is required</div>
                </div>
                <div class="form-group">
                    <label for="sae-form1" class="required">Primary Form List</label>
                    <input type="text" id="sae-form1" class="form-control" placeholder="Enter primary form list" required>
                    <div class="error-message" id="sae-form1-error">Primary form list is required</div>
                </div>
                <div class="form-group">
                    <label for="sae-visit1" class="required">Applicable visits</label>
                    <input type="text" id="sae-visit1" class="form-control" placeholder="Enter visits" required>
                    <div class="error-message" id="sae-visit1-error">Visits are required</div>
                    <div class="form-hint">Enter comma separated visits if multiple (e.g., VISIT1,VISIT2,VISIT3)</div>
                </div>
                <div class="form-group">
                    <label for="sae-form2" class="required">Related Form List</label>
                    <input type="text" id="sae-form2" class="form-control" placeholder="Enter related form" required>
                    <div class="error-message" id="sae-form2-error">Related form list is required</div>
                    <div class="form-hint">Enter comma separated forms if multiple (e.g., FORM1,FORM2,FORM3)</div>
                </div>
                <div class="form-group">
                    <label for="sae-visit2" class="required">Related Visit List</label>
                    <input type="text" id="sae-visit2" class="form-control" placeholder="Enter related visits" required>
                    <div class="error-message" id="sae-visit2-error">Related visits are required</div>
                </div>
                <div class="form-group">
                    <label for="sae-trigger-col" class="required">Trigger Column</label>
                    <input type="text" id="sae-trigger-col" class="form-control" placeholder="Enter trigger column name" required>
                    <div class="error-message" id="sae-trigger-col-error">Trigger column is required</div>
                </div>
                <div class="form-group">
                    <label for="sae-trigger-val" class="required">Trigger Value</label>
                    <input type="text" id="sae-trigger-val" class="form-control" placeholder="Enter trigger value" required>
                    <div class="error-message" id="sae-trigger-val-error">Trigger value is required</div>
                </div>
                <div class="form-group">
                    <label for="sae-filter-func" class="required">Filter Function Name</label>
                    <div class="select-wrapper">
                        <select id="sae-filter-func" class="form-control" onchange="handleSaeFilterFuncChange()" required>
                            <option value="udf_glbl_filter_by_form_visit">udf_glbl_filter_by_form_visit</option>
                            <option value="udf_glbl_filter_by_formid_visitid">udf_glbl_filter_by_formid_visitid</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="sae-filter-func-custom" class="form-control hidden" placeholder="Enter custom filter function name">
                    <div class="error-message" id="sae-filter-func-error">Filter function is required</div>
                </div>
                <div class="form-group">
                    <label for="sae-query-func" class="required">Query Text Function</label>
                    <div class="select-wrapper">
                        <select id="sae-query-func" class="form-control" onchange="handleSaeQueryFuncChange()" required>
                            <option value="udf_glbl_update_querytext">udf_glbl_update_querytext</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="sae-query-func-custom" class="form-control hidden" placeholder="Enter custom query text function">
                    <div class="error-message" id="sae-query-func-error">Query text function is required</div>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="validateAndGenerateSaeCode()">Generate Python Code</button>
                    <button class="btn btn-clear" onclick="clearSaeInputs()">Clear Inputs</button>
                </div>
                
                <div class="code-container hidden" id="sae-code-output">
                    <div class="code-header">
                        <span>Generated Python Code:</span>
                        <button class="copy-btn" onclick="copyToClipboard('sae-code-content')">Copy to Clipboard</button>
                    </div>
                    <pre id="sae-code-content"></pre>
                </div>
            </div>
            
            <!-- Form Missing Check Generator -->
            <div class="generator-container hidden" id="form-missing-generator">
                <div class="generator-header">
                    <h3>Drug accountability Missing Check</h3>
                </div>
                
                <!-- New info boxes -->
                <div class="info-boxes">
                    <div class="info-box">
                        <h4>Description</h4>
                        <p>If Event Date is present, drug accountability data should be present. Programming note: Check should fire when SYSDATE is <35> days after the date of visit.</p>
                    </div>
                    <div class="info-box">
                        <h4>Query Text</h4>
                        <p>Drug accountability data is missing for [Visit]. Please complete drug accountability in IRT</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="form-rule-name" class="required">Rule Name</label>
                    <input type="text" id="form-rule-name" class="form-control" placeholder="Enter rule name" required>
                    <div class="error-message" id="form-rule-name-error">Rule name is required</div>
                </div>
                <div class="form-group">
                    <label for="form-domain1" class="required">Primary Domain</label>
                    <input type="text" id="form-domain1" class="form-control" placeholder="Enter primary domain" required>
                    <div class="error-message" id="form-domain1-error">Primary domain is required</div>
                </div>
                <div class="form-group">
                    <label for="form-domain2" class="required">Related Domain</label>
                    <input type="text" id="form-domain2" class="form-control" placeholder="Enter related domain" required>
                    <div class="error-message" id="form-domain2-error">Related domain is required</div>
                </div>
                <div class="form-group">
                    <label for="form-domain3" class="required">Additional Domain</label>
                    <input type="text" id="form-domain3" class="form-control" placeholder="Enter additional domain" required>
                    <div class="error-message" id="form-domain3-error">Additional domain is required</div>
                </div>
                <div class="form-group">
                    <label for="form-form1" class="required">Primary Form List</label>
                    <input type="text" id="form-form1" class="form-control" placeholder="Enter primary form list" required>
                    <div class="error-message" id="form-form1-error">Primary form list is required</div>
                </div>
                <div class="form-group">
                    <label for="form-visit1" class="required">Applicable visits</label>
                    <input type="text" id="form-visit1" class="form-control" placeholder="Enter visits" required>
                    <div class="error-message" id="form-visit1-error">Visits are required</div>
                    <div class="form-hint">Enter comma separated visits if multiple (e.g., VISIT1,VISIT2,VISIT3)</div>
                </div>
                <div class="form-group">
                    <label for="form-var1" class="required">Primary Date Column</label>
                    <input type="text" id="form-var1" class="form-control" placeholder="Enter primary date column" required>
                    <div class="error-message" id="form-var1-error">Primary date column is required</div>
                </div>
                <div class="form-group">
                    <label for="form-var2" class="required">Related Date Column</label>
                    <input type="text" id="form-var2" class="form-control" placeholder="Enter related date column" required>
                    <div class="error-message" id="form-var2-error">Related date column is required</div>
                </div>
                <div class="form-group">
                    <label for="form-days" class="required">Additional Days</label>
                    <input type="number" id="form-days" class="form-control" placeholder="Enter additional days" required>
                    <div class="error-message" id="form-days-error">Additional days are required</div>
                </div>
                <div class="form-group">
                    <label for="form-filter-func" class="required">Filter Function Name</label>
                    <div class="select-wrapper">
                        <select id="form-filter-func" class="form-control" onchange="handleFormFilterFuncChange()" required>
                            <option value="udf_glbl_filter_by_form_visit">udf_glbl_filter_by_form_visit</option>
                            <option value="udf_glbl_filter_by_formid_visitid">udf_glbl_filter_by_formid_visitid</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="form-filter-func-custom" class="form-control hidden" placeholder="Enter custom filter function name">
                    <div class="error-message" id="form-filter-func-error">Filter function is required</div>
                </div>
                <div class="form-group">
                    <label for="form-query-func" class="required">Query Text Function</label>
                    <div class="select-wrapper">
                        <select id="form-query-func" class="form-control" onchange="handleFormQueryFuncChange()" required>
                            <option value="udf_glbl_update_querytext">udf_glbl_update_querytext</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="form-query-func-custom" class="form-control hidden" placeholder="Enter custom query text function">
                    <div class="error-message" id="form-query-func-error">Query text function is required</div>
                </div>
                <div class="form-group">
                    <label for="form-date-func1" class="required">Date Function 1</label>
                    <input type="text" id="form-date-func1" class="form-control" placeholder="Enter date function 1" value="udf_glbl_get_date" required>
                    <div class="error-message" id="form-date-func1-error">Date function 1 is required</div>
                </div>
                <div class="form-group">
                    <label for="form-date-func2" class="required">Date Function 2</label>
                    <input type="text" id="form-date-func2" class="form-control" placeholder="Enter date function 2" value="udf_glbl_get_date" required>
                    <div class="error-message" id="form-date-func2-error">Date function 2 is required</div>
                </div>
                <div class="form-group">
                    <label for="form-comp-func" class="required">Comparison Function</label>
                    <input type="text" id="form-comp-func" class="form-control" placeholder="Enter comparison function" value="udf_glbl_compare_dates" required>
                    <div class="error-message" id="form-comp-func-error">Comparison function is required</div>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="validateAndGenerateFormCode()">Generate Python Code</button>
                    <button class="btn btn-clear" onclick="clearFormInputs()">Clear Inputs</button>
                </div>
                
                <div class="code-container hidden" id="form-code-output">
                    <div class="code-header">
                        <span>Generated Python Code:</span>
                        <button class="copy-btn" onclick="copyToClipboard('form-code-content')">Copy to Clipboard</button>
                    </div>
                    <pre id="form-code-content"></pre>
                </div>
            </div>
            
            <!-- Greater Than Check Generator -->
            <div class="generator-container hidden" id="greater-than-generator">
                <div class="generator-header">
                    <h3>Primary is after Secondary Check</h3>
                </div>
                
                <!-- New info boxes -->
                <div class="info-boxes">
                    <div class="info-box">
                        <h4>Description</h4>
                        <p>Date of primary record should not be after Date of secondary record</p>
                    </div>
                    <div class="info-box">
                        <h4>Query Text</h4>
                        <p>Date of primary record is after the Date of secondary record. Please update the date or clarify.</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="gt-rule-name" class="required">Rule Name</label>
                    <input type="text" id="gt-rule-name" class="form-control" placeholder="Enter rule name" required>
                    <div class="error-message" id="gt-rule-name-error">Rule name is required</div>
                </div>
                <div class="form-group">
                    <label for="gt-domain1" class="required">Primary Domain</label>
                    <input type="text" id="gt-domain1" class="form-control" placeholder="Enter primary domain" required>
                    <div class="error-message" id="gt-domain1-error">Primary domain is required</div>
                </div>
                <div class="form-group">
                    <label for="gt-domain2" class="required">Related Domain</label>
                    <input type="text" id="gt-domain2" class="form-control" placeholder="Enter related domain" required>
                    <div class="error-message" id="gt-domain2-error">Related domain is required</div>
                </div>
                <div class="form-group">
                    <label for="gt-form1" class="required">Primary Form List</label>
                    <input type="text" id="gt-form1" class="form-control" placeholder="Enter primary form list" required>
                    <div class="error-message" id="gt-form1-error">Primary form list is required</div>
                </div>
                <div class="form-group">
                    <label for="gt-visit1" class="required">Primary Visit List</label>
                    <input type="text" id="gt-visit1" class="form-control" placeholder="Enter primary visits" required>
                    <div class="error-message" id="gt-visit1-error">Primary visits are required</div>
                    <div class="form-hint">Enter comma separated visits if multiple (e.g., VISIT1,VISIT2,VISIT3)</div>
                </div>
                <div class="form-group">
                    <label for="gt-form2" class="required">Related Form List</label>
                    <input type="text" id="gt-form2" class="form-control" placeholder="Enter related form list" required>
                    <div class="error-message" id="gt-form2-error">Related form list is required</div>
                </div>
                <div class="form-group">
                    <label for="gt-visit2" class="required">Related Visit List</label>
                    <input type="text" id="gt-visit2" class="form-control" placeholder="Enter related visits" required>
                    <div class="error-message" id="gt-visit2-error">Related visits are required</div>
                    <div class="form-hint">Enter comma separated visits if multiple (e.g., VISIT1,VISIT2,VISIT3)</div>
                </div>
                <div class="form-group">
                    <label for="gt-prim-date-col" class="required">Primary Date Column</label>
                    <input type="text" id="gt-prim-date-col" class="form-control" placeholder="Enter primary date column" required>
                    <div class="error-message" id="gt-prim-date-col-error">Primary date column is required</div>
                </div>
                <div class="form-group">
                    <label for="gt-rel-date-col" class="required">Related Date Column</label>
                    <input type="text" id="gt-rel-date-col" class="form-control" placeholder="Enter related date column" required>
                    <div class="error-message" id="gt-rel-date-col-error">Related date column is required</div>
                </div>
                <div class="form-group">
                    <label for="gt-filter-func" class="required">Filter Function Name</label>
                    <div class="select-wrapper">
                        <select id="gt-filter-func" class="form-control" onchange="handleGtFilterFuncChange()" required>
                            <option value="udf_glbl_filter_by_form_visit">udf_glbl_filter_by_form_visit</option>
                            <option value="udf_glbl_filter_by_formid_visitid">udf_glbl_filter_by_formid_visitid</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="gt-filter-func-custom" class="form-control hidden" placeholder="Enter custom filter function name">
                    <div class="error-message" id="gt-filter-func-error">Filter function is required</div>
                </div>
                <div class="form-group">
                    <label for="gt-null-check-func" class="required">Null Check Function</label>
                    <input type="text" id="gt-null-check-func" class="form-control" placeholder="Enter null check function" value="udf_glbl_compare_dates" required>
                    <div class="error-message" id="gt-null-check-func-error">Null check function is required</div>
                </div>
                <div class="form-group">
                    <label for="gt-date-func" class="required">Date Function</label>
                    <input type="text" id="gt-date-func" class="form-control" placeholder="Enter date function" value="udf_glbl_get_date" required>
                    <div class="error-message" id="gt-date-func-error">Date function is required</div>
                </div>
                <div class="form-group">
                    <label for="gt-comp-func" class="required">Comparison Function</label>
                    <input type="text" id="gt-comp-func" class="form-control" placeholder="Enter comparison function" value="udf_glbl_compare_dates" required>
                    <div class="error-message" id="gt-comp-func-error">Comparison function is required</div>
                </div>
                <div class="form-group">
                    <label for="gt-query-func" class="required">Query Text Function</label>
                    <div class="select-wrapper">
                        <select id="gt-query-func" class="form-control" onchange="handleGtQueryFuncChange()" required>
                            <option value="udf_glbl_update_querytext">udf_glbl_update_querytext</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="gt-query-func-custom" class="form-control hidden" placeholder="Enter custom query text function">
                    <div class="error-message" id="gt-query-func-error">Query text function is required</div>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="validateAndGenerateGtCode()">Generate Python Code</button>
                    <button class="btn btn-clear" onclick="clearGtInputs()">Clear Inputs</button>
                </div>
                
                <div class="code-container hidden" id="gt-code-output">
                    <div class="code-header">
                        <span>Generated Python Code:</span>
                        <button class="copy-btn" onclick="copyToClipboard('gt-code-content')">Copy to Clipboard</button>
                    </div>
                    <pre id="gt-code-content"></pre>
                </div>
            </div>
                        
            <!-- Less Than Check Generator -->
            <div class="generator-container hidden" id="less-than-generator">
                <div class="generator-header">
                    <h3>Primary is before Secondary Check</h3>
                </div>
                
                <!-- New info boxes -->
                <div class="info-boxes">
                    <div class="info-box">
                        <h4>Description</h4>
                        <p>Date of primary record should not be before Date of secondary record</p>
                    </div>
                    <div class="info-box">
                        <h4>Query Text</h4>
                        <p>Date of primary record is before the Date of secondary record. Please update the date or clarify.</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="lt-rule-name" class="required">Rule Name</label>
                    <input type="text" id="lt-rule-name" class="form-control" placeholder="Enter rule name" required>
                    <div class="error-message" id="lt-rule-name-error">Rule name is required</div>
                </div>
                <div class="form-group">
                    <label for="lt-domain1" class="required">Primary Domain</label>
                    <input type="text" id="lt-domain1" class="form-control" placeholder="Enter primary domain" required>
                    <div class="error-message" id="lt-domain1-error">Primary domain is required</div>
                </div>
                <div class="form-group">
                    <label for="lt-domain2" class="required">Related Domain</label>
                    <input type="text" id="lt-domain2" class="form-control" placeholder="Enter related domain" required>
                    <div class="error-message" id="lt-domain2-error">Related domain is required</div>
                </div>
                <div class="form-group">
                    <label for="lt-form1" class="required">Primary Form List</label>
                    <input type="text" id="lt-form1" class="form-control" placeholder="Enter primary form list" required>
                    <div class="error-message" id="lt-form1-error">Primary form list is required</div>
                </div>
                <div class="form-group">
                    <label for="lt-visit1" class="required">Primary Visit List</label>
                    <input type="text" id="lt-visit1" class="form-control" placeholder="Enter primary visits" required>
                    <div class="error-message" id="lt-visit1-error">Primary visits are required</div>
                    <div class="form-hint">Enter comma separated visits if multiple (e.g., VISIT1,VISIT2,VISIT3)</div>
                </div>
                <div class="form-group">
                    <label for="lt-form2" class="required">Related Form List</label>
                    <input type="text" id="lt-form2" class="form-control" placeholder="Enter related form list" required>
                    <div class="error-message" id="lt-form2-error">Related form list is required</div>
                </div>
                <div class="form-group">
                    <label for="lt-visit2" class="required">Related Visit List</label>
                    <input type="text" id="lt-visit2" class="form-control" placeholder="Enter related visits" required>
                    <div class="error-message" id="lt-visit2-error">Related visits are required</div>
                    <div class="form-hint">Enter comma separated visits if multiple (e.g., VISIT1,VISIT2,VISIT3)</div>
                </div>
                <div class="form-group">
                    <label for="lt-prim-date-col" class="required">Primary Date Column</label>
                    <input type="text" id="lt-prim-date-col" class="form-control" placeholder="Enter primary date column" required>
                    <div class="error-message" id="lt-prim-date-col-error">Primary date column is required</div>
                </div>
                <div class="form-group">
                    <label for="lt-rel-date-col" class="required">Related Date Column</label>
                    <input type="text" id="lt-rel-date-col" class="form-control" placeholder="Enter related date column" required>
                    <div class="error-message" id="lt-rel-date-col-error">Related date column is required</div>
                </div>
                <div class="form-group">
                    <label for="lt-filter-func" class="required">Filter Function Name</label>
                    <div class="select-wrapper">
                        <select id="lt-filter-func" class="form-control" onchange="handleLtFilterFuncChange()" required>
                            <option value="udf_glbl_filter_by_form_visit">udf_glbl_filter_by_form_visit</option>
                            <option value="udf_glbl_filter_by_formid_visitid">udf_glbl_filter_by_formid_visitid</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="lt-filter-func-custom" class="form-control hidden" placeholder="Enter custom filter function name">
                    <div class="error-message" id="lt-filter-func-error">Filter function is required</div>
                </div>
                <div class="form-group">
                    <label for="lt-null-check-func" class="required">Null Check Function</label>
                    <input type="text" id="lt-null-check-func" class="form-control" placeholder="Enter null check function" value="udf_glbl_compare_dates" required>
                    <div class="error-message" id="lt-null-check-func-error">Null check function is required</div>
                </div>
                <div class="form-group">
                    <label for="lt-date-func" class="required">Date Function</label>
                    <input type="text" id="lt-date-func" class="form-control" placeholder="Enter date function" value="udf_glbl_get_date" required>
                    <div class="error-message" id="lt-date-func-error">Date function is required</div>
                </div>
                <div class="form-group">
                    <label for="lt-comp-func" class="required">Comparison Function</label>
                    <input type="text" id="lt-comp-func" class="form-control" placeholder="Enter comparison function" value="udf_glbl_compare_dates" required>
                    <div class="error-message" id="lt-comp-func-error">Comparison function is required</div>
                </div>
                <div class="form-group">
                    <label for="lt-query-func" class="required">Query Text Function</label>
                    <div class="select-wrapper">
                        <select id="lt-query-func" class="form-control" onchange="handleLtQueryFuncChange()" required>
                            <option value="udf_glbl_update_querytext">udf_glbl_update_querytext</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="lt-query-func-custom" class="form-control hidden" placeholder="Enter custom query text function">
                    <div class="error-message" id="lt-query-func-error">Query text function is required</div>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="validateAndGenerateLtCode()">Generate Python Code</button>
                    <button class="btn btn-clear" onclick="clearLtInputs()">Clear Inputs</button>
                </div>
                
                <div class="code-container hidden" id="lt-code-output">
                    <div class="code-header">
                        <span>Generated Python Code:</span>
                        <button class="copy-btn" onclick="copyToClipboard('lt-code-content')">Copy to Clipboard</button>
                    </div>
                    <pre id="lt-code-content"></pre>
                </div>
            </div>
            
            <!-- SI Unit Check Generator -->
            <div class="generator-container hidden" id="si-unit-generator">
                <div class="generator-header">
                    <h3>SI unit should exist in global lab Check</h3>
                </div>
                
                <!-- New info boxes -->
                <div class="info-boxes">
                    <div class="info-box">
                        <h4>Description</h4>
                        <p>SI unit should exist in global lab tables for lab test.</p>
                    </div>
                    <div class="info-box">
                        <h4>Query Text</h4>
                        <p>DM Review: Test name: [Test name]: SI Unit is not defined in the global lab tables for the lab test. Please contact the Lab SME team and DWA.</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="si-rule-name" class="required">Rule Name</label>
                    <input type="text" id="si-rule-name" class="form-control" placeholder="Enter rule name" required>
                    <div class="error-message" id="si-rule-name-error">Rule name is required</div>
                </div>
                <div class="form-group">
                    <label for="si-domain" class="required">Domain Name</label>
                    <input type="text" id="si-domain" class="form-control" placeholder="Enter domain name" value="LB" required>
                    <div class="error-message" id="si-domain-error">Domain name is required</div>
                </div>
                <div class="form-group">
                    <label for="si-lbcat" class="required">LBCAT Value</label>
                    <input type="text" id="si-lbcat" class="form-control" placeholder="Enter LBCAT value to match" required>
                    <div class="error-message" id="si-lbcat-error">LBCAT value is required</div>
                </div>
                <div class="form-group">
                    <label for="si-form" class="required">Form List</label>
                    <input type="text" id="si-form" class="form-control" placeholder="Enter form list" required>
                    <div class="error-message" id="si-form-error">Form list is required</div>
                </div>
                <div class="form-group">
                    <label for="si-visit" class="required">Visit List</label>
                    <input type="text" id="si-visit" class="form-control" placeholder="Enter visit list" required>
                    <div class="error-message" id="si-visit-error">Visit list is required</div>
                    <div class="form-hint">Enter comma separated visits if multiple (e.g., VISIT1,VISIT2,VISIT3)</div>
                </div>
                <div class="form-group">
                    <label for="si-filter-func" class="required">Filter Function Name</label>
                    <div class="select-wrapper">
                        <select id="si-filter-func" class="form-control" onchange="handleSiFilterFuncChange()" required>
                            <option value="udf_glbl_filter_by_form_visit">udf_glbl_filter_by_form_visit</option>
                            <option value="udf_glbl_filter_by_formid_visitid">udf_glbl_filter_by_formid_visitid</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="si-filter-func-custom" class="form-control hidden" placeholder="Enter custom filter function name">
                    <div class="error-message" id="si-filter-func-error">Filter function is required</div>
                </div>
                <div class="form-group">
                    <label for="si-query-func" class="required">Query Text Function</label>
                    <div class="select-wrapper">
                        <select id="si-query-func" class="form-control" onchange="handleSiQueryFuncChange()" required>
                            <option value="udf_glbl_update_querytext">udf_glbl_update_querytext</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="si-query-func-custom" class="form-control hidden" placeholder="Enter custom query text function">
                    <div class="error-message" id="si-query-func-error">Query text function is required</div>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="validateAndGenerateSiCode()">Generate Python Code</button>
                    <button class="btn btn-clear" onclick="clearSiInputs()">Clear Inputs</button>
                </div>
                
                <div class="code-container hidden" id="si-code-output">
                    <div class="code-header">
                        <span>Generated Python Code:</span>
                        <button class="copy-btn" onclick="copyToClipboard('si-code-content')">Copy to Clipboard</button>
                    </div>
                    <pre id="si-code-content"></pre>
                </div>
            </div>
            
            <!-- US Unit Check Generator -->
            <div class="generator-container hidden" id="us-unit-generator">
                <div class="generator-header">
                    <h3>US unit should exist in global lab Check</h3>
                </div>
                
                <!-- New info boxes -->
                <div class="info-boxes">
                    <div class="info-box">
                        <h4>Description</h4>
                        <p>US unit should exist in global lab tables for lab test.</p>
                    </div>
                    <div class="info-box">
                        <h4>Query Text</h4>
                        <p>DM Review: Test name: [Test name]: US Unit is not defined in the global lab tables for the lab test. Please contact the Lab SME team and DWA.</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="us-rule-name" class="required">Rule Name</label>
                    <input type="text" id="us-rule-name" class="form-control" placeholder="Enter rule name" required>
                    <div class="error-message" id="us-rule-name-error">Rule name is required</div>
                </div>
                <div class="form-group">
                    <label for="us-domain" class="required">Domain Name</label>
                    <input type="text" id="us-domain" class="form-control" placeholder="Enter domain name" value="LB" required>
                    <div class="error-message" id="us-domain-error">Domain name is required</div>
                </div>
                <div class="form-group">
                    <label for="us-lbcat" class="required">LBCAT Value</label>
                    <input type="text" id="us-lbcat" class="form-control" placeholder="Enter LBCAT value to match" required>
                    <div class="error-message" id="us-lbcat-error">LBCAT value is required</div>
                </div>
                <div class="form-group">
                    <label for="us-form" class="required">Form List</label>
                    <input type="text" id="us-form" class="form-control" placeholder="Enter form list" required>
                    <div class="error-message" id="us-form-error">Form list is required</div>
                </div>
                <div class="form-group">
                    <label for="us-visit" class="required">Visit List</label>
                    <input type="text" id="us-visit" class="form-control" placeholder="Enter visit list" required>
                    <div class="error-message" id="us-visit-error">Visit list is required</div>
                    <div class="form-hint">Enter comma separated visits if multiple (e.g., VISIT1,VISIT2,VISIT3)</div>
                </div>
                <div class="form-group">
                    <label for="us-filter-func" class="required">Filter Function Name</label>
                    <div class="select-wrapper">
                        <select id="us-filter-func" class="form-control" onchange="handleUsFilterFuncChange()" required>
                            <option value="udf_glbl_filter_by_form_visit">udf_glbl_filter_by_form_visit</option>
                            <option value="udf_glbl_filter_by_formid_visitid">udf_glbl_filter_by_formid_visitid</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="us-filter-func-custom" class="form-control hidden" placeholder="Enter custom filter function name">
                    <div class="error-message" id="us-filter-func-error">Filter function is required</div>
                </div>
                <div class="form-group">
                    <label for="us-query-func" class="required">Query Text Function</label>
                    <div class="select-wrapper">
                        <select id="us-query-func" class="form-control" onchange="handleUsQueryFuncChange()" required>
                            <option value="udf_glbl_update_querytext">udf_glbl_update_querytext</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="us-query-func-custom" class="form-control hidden" placeholder="Enter custom query text function">
                    <div class="error-message" id="us-query-func-error">Query text function is required</div>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="validateAndGenerateUsCode()">Generate Python Code</button>
                    <button class="btn btn-clear" onclick="clearUsInputs()">Clear Inputs</button>
                </div>
                
                <div class="code-container hidden" id="us-code-output">
                    <div class="code-header">
                        <span>Generated Python Code:</span>
                        <button class="copy-btn" onclick="copyToClipboard('us-code-content')">Copy to Clipboard</button>
                    </div>
                    <pre id="us-code-content"></pre>
                </div>
            </div>

            <!-- SI Numeric Check Generator -->
            <div class="generator-container hidden" id="si-numeric-generator">
                <div class="generator-header">
                    <h3>Reported unit is present and result is numeric (SI Unit Check)</h3>
                </div>
                
                <div class="info-boxes">
                    <div class="info-box">
                        <h4>Description</h4>
                        <p>If reported unit is present and result is numeric, a conversion between the reported unit and the corresponding SI unit defined in the global lab tables should be present for lab test.</p>
                    </div>
                    <div class="info-box">
                        <h4>Query Text</h4>
                        <p>DM Review: Test name: [Test name], Reported unit: [Reported unit]: Conversion is missing for reported unit to SI unit. Please contact the Lab SME team and DWA.</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="si-numeric-rule-name" class="required">Rule Name</label>
                    <input type="text" id="si-numeric-rule-name" class="form-control" placeholder="Enter rule name" required>
                    <div class="error-message" id="si-numeric-rule-name-error">Rule name is required</div>
                </div>
                <div class="form-group">
                    <label for="si-numeric-domain" class="required">Domain Name</label>
                    <input type="text" id="si-numeric-domain" class="form-control" placeholder="Enter domain name" value="LB" required>
                    <div class="error-message" id="si-numeric-domain-error">Domain name is required</div>
                </div>
                <div class="form-group">
                    <label for="si-numeric-lbcat" class="required">LBCAT Value</label>
                    <input type="text" id="si-numeric-lbcat" class="form-control" placeholder="Enter LBCAT value to match" required>
                    <div class="error-message" id="si-numeric-lbcat-error">LBCAT value is required</div>
                </div>
                <div class="form-group">
                    <label for="si-numeric-form" class="required">Form List</label>
                    <input type="text" id="si-numeric-form" class="form-control" placeholder="Enter form list" required>
                    <div class="error-message" id="si-numeric-form-error">Form list is required</div>
                </div>
                <div class="form-group">
                    <label for="si-numeric-visit" class="required">Visit List</label>
                    <input type="text" id="si-numeric-visit" class="form-control" placeholder="Enter visit list" required>
                    <div class="error-message" id="si-numeric-visit-error">Visit list is required</div>
                    <div class="form-hint">Enter comma separated visits if multiple (e.g., VISIT1,VISIT2,VISIT3)</div>
                </div>
                <div class="form-group">
                    <label for="si-numeric-filter-func" class="required">Filter Function Name</label>
                    <div class="select-wrapper">
                        <select id="si-numeric-filter-func" class="form-control" onchange="handleSiNumericFilterFuncChange()" required>
                            <option value="udf_glbl_filter_by_form_visit">udf_glbl_filter_by_form_visit</option>
                            <option value="udf_glbl_filter_by_formid_visitid">udf_glbl_filter_by_formid_visitid</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="si-numeric-filter-func-custom" class="form-control hidden" placeholder="Enter custom filter function name">
                    <div class="error-message" id="si-numeric-filter-func-error">Filter function is required</div>
                </div>
                <div class="form-group">
                    <label for="si-numeric-query-func" class="required">Query Text Function</label>
                    <div class="select-wrapper">
                        <select id="si-numeric-query-func" class="form-control" onchange="handleSiNumericQueryFuncChange()" required>
                            <option value="udf_glbl_update_querytext">udf_glbl_update_querytext</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="si-numeric-query-func-custom" class="form-control hidden" placeholder="Enter custom query text function">
                    <div class="error-message" id="si-numeric-query-func-error">Query text function is required</div>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="validateAndGenerateSiNumericCode()">Generate Python Code</button>
                    <button class="btn btn-clear" onclick="clearSiNumericInputs()">Clear Inputs</button>
                </div>
                
                <div class="code-container hidden" id="si-numeric-code-output">
                    <div class="code-header">
                        <span>Generated Python Code:</span>
                        <button class="copy-btn" onclick="copyToClipboard('si-numeric-code-content')">Copy to Clipboard</button>
                    </div>
                    <pre id="si-numeric-code-content"></pre>
                </div>
            </div>

            <!-- US Numeric Check Generator -->
            <div class="generator-container hidden" id="us-numeric-generator">
                <div class="generator-header">
                    <h3>Reported unit is present and result is numeric (US Unit Check)</h3>
                </div>
                
                <!-- New info boxes -->
                <div class="info-boxes">
                    <div class="info-box">
                        <h4>Description</h4>
                        <p>If reported unit is present and result is numeric, a conversion between the reported unit and the corresponding US unit defined in the global lab tables should be present for lab test.</p>
                    </div>
                    <div class="info-box">
                        <h4>Query Text</h4>
                        <p>DM Review: Test name: [Test name], Reported unit: [Reported unit]: Conversion is missing for reported unit to US unit. Please contact the Lab SME team and DWA.</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="us-numeric-rule-name" class="required">Rule Name</label>
                    <input type="text" id="us-numeric-rule-name" class="form-control" placeholder="Enter rule name" required>
                    <div class="error-message" id="us-numeric-rule-name-error">Rule name is required</div>
                </div>
                <div class="form-group">
                    <label for="us-numeric-domain" class="required">Domain Name</label>
                    <input type="text" id="us-numeric-domain" class="form-control" placeholder="Enter domain name" value="LB" required>
                    <div class="error-message" id="us-numeric-domain-error">Domain name is required</div>
                </div>
                <div class="form-group">
                    <label for="us-numeric-lbcat" class="required">LBCAT Value</label>
                    <input type="text" id="us-numeric-lbcat" class="form-control" placeholder="Enter LBCAT value to match" required>
                    <div class="error-message" id="us-numeric-lbcat-error">LBCAT value is required</div>
                </div>
                <div class="form-group">
                    <label for="us-numeric-form" class="required">Form List</label>
                    <input type="text" id="us-numeric-form" class="form-control" placeholder="Enter form list" required>
                    <div class="error-message" id="us-numeric-form-error">Form list is required</div>
                </div>
                <div class="form-group">
                    <label for="us-numeric-visit" class="required">Visit List</label>
                    <input type="text" id="us-numeric-visit" class="form-control" placeholder="Enter visit list" required>
                    <div class="error-message" id="us-numeric-visit-error">Visit list is required</div>
                    <div class="form-hint">Enter comma separated visits if multiple (e.g., VISIT1,VISIT2,VISIT3)</div>
                </div>
                <div class="form-group">
                    <label for="us-numeric-filter-func" class="required">Filter Function Name</label>
                    <div class="select-wrapper">
                        <select id="us-numeric-filter-func" class="form-control" onchange="handleUsNumericFilterFuncChange()" required>
                            <option value="udf_glbl_filter_by_form_visit">udf_glbl_filter_by_form_visit</option>
                            <option value="udf_glbl_filter_by_formid_visitid">udf_glbl_filter_by_formid_visitid</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="us-numeric-filter-func-custom" class="form-control hidden" placeholder="Enter custom filter function name">
                    <div class="error-message" id="us-numeric-filter-func-error">Filter function is required</div>
                </div>
                <div class="form-group">
                    <label for="us-numeric-query-func" class="required">Query Text Function</label>
                    <div class="select-wrapper">
                        <select id="us-numeric-query-func" class="form-control" onchange="handleUsNumericQueryFuncChange()" required>
                            <option value="udf_glbl_update_querytext">udf_glbl_update_querytext</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="us-numeric-query-func-custom" class="form-control hidden" placeholder="Enter custom query text function">
                    <div class="error-message" id="us-numeric-query-func-error">Query text function is required</div>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="validateAndGenerateUsNumericCode()">Generate Python Code</button>
                    <button class="btn btn-clear" onclick="clearUsNumericInputs()">Clear Inputs</button>
                </div>
                
                <div class="code-container hidden" id="us-numeric-code-output">
                    <div class="code-header">
                        <span>Generated Python Code:</span>
                        <button class="copy-btn" onclick="copyToClipboard('us-numeric-code-content')">Copy to Clipboard</button>
                    </div>
                    <pre id="us-numeric-code-content"></pre>
                </div>
            </div>
            
            <!-- Common Check 1 Generator -->
            <div class="generator-container hidden" id="common-check-1-generator">
                <div class="generator-header">
                    <h3>Duplicate Entries Check</h3>
                </div>
                
                <!-- New info boxes -->
                <div class="info-boxes">
                    <div class="info-box">
                        <h4>Description</h4>
                        <p>Ensure that no duplicate entries exist for eCRF</p>
                    </div>
                    <div class="info-box">
                        <h4>Query Text</h4>
                        <p>Subject has Duplicate records. Please verify</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="cc1-rule-name" class="required">Rule Name</label>
                    <input type="text" id="cc1-rule-name" class="form-control" placeholder="Enter rule name" required>
                    <div class="error-message" id="cc1-rule-name-error">Rule name is required</div>
                </div>
                <div class="form-group">
                    <label for="cc1-domain" class="required">Domain Name</label>
                    <input type="text" id="cc1-domain" class="form-control" placeholder="Enter domain name" required>
                    <div class="error-message" id="cc1-domain-error">Domain name is required</div>
                </div>
                <div class="form-group">
                    <label for="cc1-form" class="required">Form List</label>
                    <input type="text" id="cc1-form" class="form-control" placeholder="Enter form list" required>
                    <div class="error-message" id="cc1-form-error">Form list is required</div>
                </div>
                <div class="form-group">
                    <label for="cc1-visit" class="required">Visit List</label>
                    <input type="text" id="cc1-visit" class="form-control" placeholder="Enter visit list" required>
                    <div class="error-message" id="cc1-visit-error">Visit list is required</div>
                    <div class="form-hint">Enter comma separated visits if multiple (e.g., VISIT1,VISIT2,VISIT3)</div>
                </div>
                <div class="form-group">
                    <label for="cc1-filter-func" class="required">Filter Function Name</label>
                    <div class="select-wrapper">
                        <select id="cc1-filter-func" class="form-control" onchange="handleCc1FilterFuncChange()" required>
                            <option value="udf_glbl_filter_by_form_visit">udf_glbl_filter_by_form_visit</option>
                            <option value="udf_glbl_filter_by_formid_visitid">udf_glbl_filter_by_formid_visitid</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="cc1-filter-func-custom" class="form-control hidden" placeholder="Enter custom filter function name">
                    <div class="error-message" id="cc1-filter-func-error">Filter function is required</div>
                </div>
                <div class="form-group">
                    <label for="cc1-query-func" class="required">Query Text Function</label>
                    <div class="select-wrapper">
                        <select id="cc1-query-func" class="form-control" onchange="handleCc1QueryFuncChange()" required>
                            <option value="udf_glbl_update_querytext">udf_glbl_update_querytext</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="cc1-query-func-custom" class="form-control hidden" placeholder="Enter custom query text function">
                    <div class="error-message" id="cc1-query-func-error">Query text function is required</div>
                </div>
                <div class="form-group">
                    <label for="cc1-dup-col" class="required">Duplicate Check Column</label>
                    <input type="text" id="cc1-dup-col" class="form-control" placeholder="Enter column name to check for duplicates" required>
                    <div class="error-message" id="cc1-dup-col-error">Duplicate check column is required</div>
                </div>
                <div class="form-group">
                    <label for="cc1-subset-col" class="required">Subset Columns</label>
                    <input type="text" id="cc1-subset-col" class="form-control" placeholder="Enter subset columns (comma separated)" required>
                    <div class="error-message" id="cc1-subset-col-error">Subset columns are required</div>
                    <div class="form-hint">Columns to check duplicates within (e.g., SUBJID,VISIT)</div>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="validateAndGenerateCc1Code()">Generate Python Code</button>
                    <button class="btn btn-clear" onclick="clearCc1Inputs()">Clear Inputs</button>
                </div>
                
                <div class="code-container hidden" id="cc1-code-output">
                    <div class="code-header">
                        <span>Generated Python Code:</span>
                        <button class="copy-btn" onclick="copyToClipboard('cc1-code-content')">Copy to Clipboard</button>
                    </div>
                    <pre id="cc1-code-content"></pre>
                </div>
            </div>
            
            <!-- Common Check 2 Generator -->
            <div class="generator-container hidden" id="common-check-2-generator">
                <div class="generator-header">
                    <h3>Lower level term/Dictionary version/Preferred term code Check</h3>
                </div>
                
                <!-- New info boxes -->
                <div class="info-boxes">
                    <div class="info-box">
                        <h4>Description</h4>
                        <p>Lower level term/Dictionary version/Preferred term code should be present</p>
                    </div>
                    <div class="info-box">
                        <h4>Query Text</h4>
                        <p>DM Review: Lower level term or Dictionary version or Preferred term code is missing for [Term]. Please follow the coding issue handling decision tree.</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="cc2-rule-name" class="required">Rule Name</label>
                    <input type="text" id="cc2-rule-name" class="form-control" placeholder="Enter rule name" required>
                    <div class="error-message" id="cc2-rule-name-error">Rule name is required</div>
                </div>
                <div class="form-group">
                    <label for="cc2-domain" class="required">Domain Name</label>
                    <input type="text" id="cc2-domain" class="form-control" placeholder="Enter domain name" required>
                    <div class="error-message" id="cc2-domain-error">Domain name is required</div>
                </div>
                <div class="form-group">
                    <label for="cc2-form" class="required">Form List</label>
                    <input type="text" id="cc2-form" class="form-control" placeholder="Enter form list" required>
                    <div class="error-message" id="cc2-form-error">Form list is required</div>
                </div>
                <div class="form-group">
                    <label for="cc2-visit" class="required">Visit List</label>
                    <input type="text" id="cc2-visit" class="form-control" placeholder="Enter visit list" required>
                    <div class="error-message" id="cc2-visit-error">Visit list is required</div>
                    <div class="form-hint">Enter comma separated visits if multiple (e.g., VISIT1,VISIT2,VISIT3)</div>
                </div>
                <div class="form-group">
                    <label for="cc2-term-col" class="required">Term Column</label>
                    <input type="text" id="cc2-term-col" class="form-control" placeholder="Enter term column name" value="TERM" required>
                    <div class="error-message" id="cc2-term-col-error">Term column is required</div>
                </div>
                <div class="form-group">
                    <label for="cc2-lltcd-col" class="required">LLTCD Column</label>
                    <input type="text" id="cc2-lltcd-col" class="form-control" placeholder="Enter LLTCD column name" value="LLTCD" required>
                    <div class="error-message" id="cc2-lltcd-col-error">LLTCD column is required</div>
                </div>
                <div class="form-group">
                    <label for="cc2-dictv-col" class="required">DICTV Column</label>
                    <input type="text" id="cc2-dictv-col" class="form-control" placeholder="Enter DICTV column name" value="DICTV" required>
                    <div class="error-message" id="cc2-dictv-col-error">DICTV column is required</div>
                </div>
                <div class="form-group">
                    <label for="cc2-decod-col" class="required">DECOD Column</label>
                    <input type="text" id="cc2-decod-col" class="form-control" placeholder="Enter DECOD column name" value="DECOD" required>
                    <div class="error-message" id="cc2-decod-col-error">DECOD column is required</div>
                </div>
                <div class="form-group">
                    <label for="cc2-filter-func" class="required">Filter Function Name</label>
                    <div class="select-wrapper">
                        <select id="cc2-filter-func" class="form-control" onchange="handleCc2FilterFuncChange()" required>
                            <option value="udf_glbl_filter_by_form_visit">udf_glbl_filter_by_form_visit</option>
                            <option value="udf_glbl_filter_by_formid_visitid">udf_glbl_filter_by_formid_visitid</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="cc2-filter-func-custom" class="form-control hidden" placeholder="Enter custom filter function name">
                    <div class="error-message" id="cc2-filter-func-error">Filter function is required</div>
                </div>
                <div class="form-group">
                    <label for="cc2-query-func" class="required">Query Text Function</label>
                    <div class="select-wrapper">
                        <select id="cc2-query-func" class="form-control" onchange="handleCc2QueryFuncChange()" required>
                            <option value="udf_glbl_update_querytext">udf_glbl_update_querytext</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <input type="text" id="cc2-query-func-custom" class="form-control hidden" placeholder="Enter custom query text function">
                    <div class="error-message" id="cc2-query-func-error">Query text function is required</div>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="validateAndGenerateCc2Code()">Generate Python Code</button>
                    <button class="btn btn-clear" onclick="clearCc2Inputs()">Clear Inputs</button>
                </div>
                
                <div class="code-container hidden" id="cc2-code-output">
                    <div class="code-header">
                        <span>Generated Python Code:</span>
                        <button class="copy-btn" onclick="copyToClipboard('cc2-code-content')">Copy to Clipboard</button>
                    </div>
                    <pre id="cc2-code-content"></pre>
                </div>
            </div>
            
            <!-- Common Check 3 Generator (Placeholder) -->
            <div class="generator-container hidden" id="common-check-3-generator">
                <div class="generator-header">
                    <h3>Common Check 3 Generator</h3>
                </div>
                <div class="info-boxes">
                    <div class="info-box">
                        <h4>Description</h4>
                        <p>This is a placeholder for Common Check 3 functionality</p>
                    </div>
                    <div class="info-box">
                        <h4>Coming Soon</h4>
                        <p>This feature will be implemented in a future update</p>
                    </div>
                </div>
                <div class="form-group">
                    <label>This check is not yet implemented</label>
                    <p>Please check back later for updates.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Define search data
        const searchData = [
            {
                id: 'dov-anchor',
                title: 'Date of visit + Enrollment failure Check',
                description: 'If Is the subject an enrollment failure? is No and Event Date is present, eCRF should be completed',
                category: 'Missing Check'
            },
            {
                id: 'sae-trigger',
                title: 'Enrollment failure Check',
                description: 'If Is the subject an enrollment failure? is No, eCRF should be completed',
                category: 'Missing Check'
            },
            {
                id: 'form-missing',
                title: 'Drug accountability Check',
                description: 'If Event Date is present, drug accountability data should be present. Programming note: Check should fire when SYSDATE is <35> days after the date of visit.',
                category: 'Missing Check'
            },
            {
                id: 'ds-missing',
                title: 'DS Dataset Missing Check',
                description: 'If Primary reason for ending study is completed on eCRF, then, eCRF should be completed.',
                category: 'Missing Check'
            },
            {
                id: 'dates-not-equal',
                title: 'Dates are Not Equal Check',
                description: 'Date should be same as corresponding date',
                category: 'Date Comparison'
            },
            {
                id: 'greater-than',
                title: 'Primary is after Secondary Check',
                description: 'Date of primary record should not be after Date of secondary record',
                category: 'Date Comparison'
            },
            {
                id: 'less-than',
                title: 'Primary is before Secondary Check',
                description: 'Date of primary record should not be before Date of secondary record',
                category: 'Date Comparison'
            },
            {
                id: 'common-check-2',
                title: 'Lower level term/Dictionary version/Preferred term code Check',
                description: 'Lower level term/Dictionary version/Preferred term code should be present',
                category: 'Common Check'
            },
            {
                id: 'si-unit',
                title: 'SI unit should exist in global lab Check',
                description: 'SI unit should exist in global lab tables for lab test.',
                category: 'Global Check'
            },
            {
                id: 'us-unit',
                title: 'US unit should exist in global lab Check',
                description: 'US unit should exist in global lab tables for lab test.',
                category: 'Global Check'
            },
            {
                id: 'si-numeric',
                title: 'Reported unit is present and result is numeric (SI Unit Check)',
                description: 'Reported unit should be present and result should be numeric for SI units',
                category: 'Global Check'
            },
            {
                id: 'us-numeric',
                title: 'Reported unit is present and result is numeric (US Unit Check)',
                description: 'Reported unit should be present and result should be numeric for US units',
                category: 'Global Check'
            },
            {
                id: 'common-check-1',
                title: 'Duplicate Entries Check',
                description: 'Ensure that no duplicate entries exist for eCRF',
                category: 'Common Check'
            },
            {
                id: 'common-check-3',
                title: 'Common Check 3',
                description: 'Placeholder for future common check',
                category: 'Common Check'
            }
        ];
        
        function toggleSubmenu(id) {
            const submenu = document.getElementById(id);
            submenu.classList.toggle('show');
            
            // Toggle arrow icon
            const menuTitle = submenu.previousElementSibling;
            const arrow = menuTitle.querySelector('span:last-child');
            if (submenu.classList.contains('show')) {
                arrow.textContent = '‚ñ≤';
                menuTitle.classList.add('active');
            } else {
                arrow.textContent = '‚ñº';
                menuTitle.classList.remove('active');
            }
        }
        
        function showHomePage() {
            // Show welcome page
            document.getElementById('welcome-page').classList.remove('hidden');
            
            // Hide all generators
            const generators = document.querySelectorAll('.generator-container');
            generators.forEach(gen => gen.classList.add('hidden'));
            
            // Hide all code outputs
            const codeOutputs = document.querySelectorAll('.code-container');
            codeOutputs.forEach(output => output.classList.add('hidden'));
        }
        
        function showGenerator(generatorId) {
            // Hide welcome page
            document.getElementById('welcome-page').classList.add('hidden');
            
            // Hide all generators
            const generators = document.querySelectorAll('.generator-container');
            generators.forEach(gen => gen.classList.add('hidden'));
            
            // Show selected generator
            document.getElementById(`${generatorId}-generator`).classList.remove('hidden');
            
            // Hide all code outputs
            const codeOutputs = document.querySelectorAll('.code-container');
            codeOutputs.forEach(output => output.classList.add('hidden'));
            
            // Close search results if open
            document.getElementById('search-results').classList.remove('show');
            
            // Clear search box
            document.getElementById('search-box').value = '';
        }
        
        function copyToClipboard(elementId) {
            const codeElement = document.getElementById(elementId);
            const textToCopy = codeElement.textContent;
            
            // Create a temporary textarea element
            const textarea = document.createElement('textarea');
            textarea.value = textToCopy;
            textarea.style.position = 'fixed';  // Prevent scrolling to bottom
            document.body.appendChild(textarea);
            textarea.select();
            
            try {
                // Execute the copy command
                const successful = document.execCommand('copy');
                const btn = event.target;
                if (successful) {
                    btn.textContent = 'Copied!';
                    btn.classList.add('copied');
                    setTimeout(() => {
                        btn.textContent = 'Copy to Clipboard';
                        btn.classList.remove('copied');
                    }, 2000);
                }
            } catch (err) {
                console.error('Failed to copy text: ', err);
            }
            
            // Clean up
            document.body.removeChild(textarea);
        }
        
        function handleFilterFuncChange() {
            const select = document.getElementById('dov-filter-func');
            const customInput = document.getElementById('dov-filter-func-custom');
            
            if (select.value === 'other') {
                customInput.classList.remove('hidden');
                customInput.value = '';
                customInput.required = true;
            } else {
                customInput.classList.add('hidden');
                customInput.required = false;
            }
        }
        
        function handleDateNeFilterFuncChange() {
            const select = document.getElementById('date-ne-filter-func');
            const customInput = document.getElementById('date-ne-filter-func-custom');
            
            if (select.value === 'other') {
                customInput.classList.remove('hidden');
                customInput.value = '';
                customInput.required = true;
            } else {
                customInput.classList.add('hidden');
                customInput.required = false;
            }
        }
        
        function handleCc1FilterFuncChange() {
            const select = document.getElementById('cc1-filter-func');
            const customInput = document.getElementById('cc1-filter-func-custom');
            
            if (select.value === 'other') {
                customInput.classList.remove('hidden');
                customInput.value = '';
                customInput.required = true;
            } else {
                customInput.classList.add('hidden');
                customInput.required = false;
            }
        }
        
        function handleQueryFuncChange() {
            const select = document.getElementById('dov-query-func');
            const customInput = document.getElementById('dov-query-func-custom');
            
            if (select.value === 'other') {
                customInput.classList.remove('hidden');
                customInput.value = '';
                customInput.required = true;
            } else {
                customInput.classList.add('hidden');
                customInput.required = false;
            }
        }
        
        function handleDateNeQueryFuncChange() {
            const select = document.getElementById('date-ne-query-func');
            const customInput = document.getElementById('date-ne-query-func-custom');
            
            if (select.value === 'other') {
                customInput.classList.remove('hidden');
                customInput.value = '';
                customInput.required = true;
            } else {
                customInput.classList.add('hidden');
                customInput.required = false;
            }
        }
        
        function handleCc1QueryFuncChange() {
            const select = document.getElementById('cc1-query-func');
            const customInput = document.getElementById('cc1-query-func-custom');
            
            if (select.value === 'other') {
                customInput.classList.remove('hidden');
                customInput.value = '';
                customInput.required = true;
            } else {
                customInput.classList.add('hidden');
                customInput.required = false;
            }
        }
        
        function clearDovInputs() {
            document.getElementById('dov-rule-name').value = '';
            document.getElementById('dov-domain1').value = '';
            document.getElementById('dov-domain2').value = '';
            document.getElementById('dov-domain3').value = '';
            document.getElementById('dov-form1').value = '';
            document.getElementById('dov-visit1').value = '';
            document.getElementById('dov-form2').value = '';
            document.getElementById('dov-form3').value = '';
            document.getElementById('dov-filter-col').value = 'DCMDATE';
            document.getElementById('dov-filter-func').value = 'udf_glbl_filter_by_form_visit';
            document.getElementById('dov-filter-func-custom').value = '';
            document.getElementById('dov-filter-func-custom').classList.add('hidden');
            document.getElementById('dov-query-func').value = 'udf_glbl_update_querytext';
            document.getElementById('dov-query-func-custom').value = '';
            document.getElementById('dov-query-func-custom').classList.add('hidden');
            document.getElementById('dov-enroll-col').value = '_V_ENROLLFAILYN';
            document.getElementById('dov-enroll-val').value = 'N';
            document.getElementById('dov-code-output').classList.add('hidden');
            
            // Clear error states for all fields including the new required ones
            clearErrors('dov-');
        }
        
        function clearDateNeInputs() {
            document.getElementById('date-ne-rule-name').value = '';
            document.getElementById('date-ne-domain1').value = '';
            document.getElementById('date-ne-domain2').value = '';
            document.getElementById('date-ne-prim-form').value = '';
            document.getElementById('date-ne-prim-visit').value = '';
            document.getElementById('date-ne-rel-form').value = '';
            document.getElementById('date-ne-prim-date-col').value = '';
            document.getElementById('date-ne-rel-date-col').value = '';
            document.getElementById('date-ne-filter-func').value = 'udf_glbl_filter_by_form_visit';
            document.getElementById('date-ne-filter-func-custom').value = '';
            document.getElementById('date-ne-filter-func-custom').classList.add('hidden');
            document.getElementById('date-ne-query-func').value = 'udf_glbl_update_querytext';
            document.getElementById('date-ne-query-func-custom').value = '';
            document.getElementById('date-ne-query-func-custom').classList.add('hidden');
            document.getElementById('date-ne-code-output').classList.add('hidden');
            
            // Clear error states
            clearErrors('date-ne-');
        }
        
        function clearCc1Inputs() {
            document.getElementById('cc1-rule-name').value = '';
            document.getElementById('cc1-domain').value = '';
            document.getElementById('cc1-form').value = '';
            document.getElementById('cc1-visit').value = '';
            document.getElementById('cc1-filter-func').value = 'udf_glbl_filter_by_form_visit';
            document.getElementById('cc1-filter-func-custom').value = '';
            document.getElementById('cc1-filter-func-custom').classList.add('hidden');
            document.getElementById('cc1-query-func').value = 'udf_glbl_update_querytext';
            document.getElementById('cc1-query-func-custom').value = '';
            document.getElementById('cc1-query-func-custom').classList.add('hidden');
            document.getElementById('cc1-dup-col').value = '';
            document.getElementById('cc1-subset-col').value = '';
            document.getElementById('cc1-code-output').classList.add('hidden');
            
            // Clear error states
            clearErrors('cc1-');
        }
        
        function clearSaeInputs() {
            document.getElementById('sae-rule-name').value = '';
            document.getElementById('sae-domain1').value = '';
            document.getElementById('sae-domain2').value = '';
            document.getElementById('sae-trigger-col').value = '';
            document.getElementById('sae-expected-val').value = '';
            document.getElementById('sae-code-output').classList.add('hidden');
            
            // Clear error states
            clearErrors('sae-');
        }
        
        function clearFormInputs() {
            document.getElementById('form-rule-name').value = '';
            document.getElementById('form-domain').value = '';
            document.getElementById('form-expected').value = '';
            document.getElementById('form-visit-col').value = '';
            document.getElementById('form-code-output').classList.add('hidden');
            
            // Clear error states
            clearErrors('form-');
        }
        
        function clearGtInputs() {
            document.getElementById('gt-rule-name').value = '';
            document.getElementById('gt-domain').value = '';
            document.getElementById('gt-col1').value = '';
            document.getElementById('gt-col2').value = '';
            document.getElementById('gt-code-output').classList.add('hidden');
            
            // Clear error states
            clearErrors('gt-');
        }
        
        function clearLtInputs() {
            document.getElementById('lt-rule-name').value = '';
            document.getElementById('lt-domain').value = '';
            document.getElementById('lt-col1').value = '';
            document.getElementById('lt-col2').value = '';
            document.getElementById('lt-code-output').classList.add('hidden');
            
            // Clear error states
            clearErrors('lt-');
        }
        
        function clearSiInputs() {
            document.getElementById('si-rule-name').value = '';
            document.getElementById('si-domain').value = '';
            document.getElementById('si-value-col').value = '';
            document.getElementById('si-unit-col').value = '';
            document.getElementById('si-expected').value = '';
            document.getElementById('si-code-output').classList.add('hidden');
            
            // Clear error states
            clearErrors('si-');
        }
        
        function clearUsInputs() {
            document.getElementById('us-rule-name').value = '';
            document.getElementById('us-domain').value = '';
            document.getElementById('us-value-col').value = '';
            document.getElementById('us-unit-col').value = '';
            document.getElementById('us-expected').value = '';
            document.getElementById('us-code-output').classList.add('hidden');
            
            // Clear error states
            clearErrors('us-');
        }
        
        function clearErrors(prefix) {
            // Find all error messages and input fields with the given prefix
            const errorMessages = document.querySelectorAll(`[id^="${prefix}"][id$="-error"]`);
            const inputs = document.querySelectorAll(`[id^="${prefix}"]:not([id$="-error"])`);
            
            // Hide error messages
            errorMessages.forEach(el => {
                el.style.display = 'none';
            });
            
            // Remove error class from inputs
            inputs.forEach(el => {
                if (el.classList) {
                    el.classList.remove('error');
                }
            });
        }
        
        function validateInputs(prefix) {
            let isValid = true;
            
            // Find all required inputs with the given prefix
            const requiredInputs = document.querySelectorAll(`[id^="${prefix}"][required]`);
            
            requiredInputs.forEach(input => {
                const errorElement = document.getElementById(`${input.id}-error`);
                
                if (!input.value.trim()) {
                    // Show error
                    input.classList.add('error');
                    if (errorElement) {
                        errorElement.style.display = 'block';
                    }
                    isValid = false;
                } else {
                    // Clear error
                    input.classList.remove('error');
                    if (errorElement) {
                        errorElement.style.display = 'none';
                    }
                }
            });
            
            return isValid;
        }
        
        function validateAndGenerateDovCode() {
            if (validateInputs('dov-')) {
                generateDovCode();
            }
        }
        
        function validateAndGenerateDateNeCode() {
            if (validateInputs('date-ne-')) {
                generateDateNeCode();
            }
        }
        
        function validateAndGenerateCc1Code() {
            if (validateInputs('cc1-')) {
                generateCc1Code();
            }
        }
        
        function validateAndGenerateSaeCode() {
            if (validateInputs('sae-')) {
                generateSaeCode();
            }
        }
        
        function validateAndGenerateFormCode() {
            if (validateInputs('form-')) {
                generateFormCode();
            }
        }
        
        function validateAndGenerateGtCode() {
            if (validateInputs('gt-')) {
                generateGtCode();
            }
        }
        
        function validateAndGenerateLtCode() {
            if (validateInputs('lt-')) {
                generateLtCode();
            }
        }
        
        function validateAndGenerateSiCode() {
            if (validateInputs('si-')) {
                generateSiCode();
            }
        }
        
        function validateAndGenerateUsCode() {
            if (validateInputs('us-')) {
                generateUsCode();
            }
        }
        
        // Helper function to process comma-separated inputs
        function processCommaSeparatedInput(input) {
            if (!input) return [];
            return input.split(',').map(item => `'${item.trim()}'`).join(', ');
        }
        
        function generateDovCode() {
            // Get user inputs
            const ruleName = document.getElementById('dov-rule-name').value;
            const domain1 = document.getElementById('dov-domain1').value;
            const domain2 = document.getElementById('dov-domain2').value;
            const domain3 = document.getElementById('dov-domain3').value;
            const form1 = document.getElementById('dov-form1').value;
            const visit1 = processCommaSeparatedInput(document.getElementById('dov-visit1').value);
            const form2 = processCommaSeparatedInput(document.getElementById('dov-form2').value);
            const form3 = document.getElementById('dov-form3').value;
            const filterCol = document.getElementById('dov-filter-col').value;
            
            // Get filter function
            let filterFunc;
            const filterFuncSelect = document.getElementById('dov-filter-func');
            if (filterFuncSelect.value === 'other') {
                filterFunc = document.getElementById('dov-filter-func-custom').value;
            } else {
                filterFunc = filterFuncSelect.value;
            }
            
            // Get query function
            let queryFunc;
            const queryFuncSelect = document.getElementById('dov-query-func');
            if (queryFuncSelect.value === 'other') {
                queryFunc = document.getElementById('dov-query-func-custom').value;
            } else {
                queryFunc = queryFuncSelect.value;
            }
            
            const enrollCol = document.getElementById('dov-enroll-col').value;
            const enrollVal = document.getElementById('dov-enroll-val').value;
            
            // Generate the code
            const code = `
"""
Rule Name: ${ruleName}
Domains: ${domain2}, ${domain1}, ${domain3}
"""

def ${ruleName}(query_text, ${domain2}, ${domain1}, ${domain3}):
    payload_records = []
    prim_df = ${domain1}.copy()
    rel_df = ${domain2}.copy()
    add_df = ${domain3}.copy()
    args_dict = {
        'prim_form_ls' : ['${form1}'],
        'prim_visit_ls' : [${visit1}],
        'rel_form_ls' : [${form2}],
        'rel_visit_ls' : [${visit1}],
        'null_values': ['null', 'Null', 'NULL', 'NaN', '', ' ', 'None', 'NaT', 'np.nan', 'nan', None, np.nan]
    }
    prim_form_ls, prim_visit_ls = args_dict['prim_form_ls'], args_dict['prim_visit_ls']
    rel_form_ls, rel_visit_ls = args_dict['rel_form_ls'], args_dict['rel_visit_ls']
    null_values = args_dict['null_values']
    prim_df = ${filterFunc}(prim_df, prim_form_ls, prim_visit_ls)
    rel_df = ${filterFunc}(rel_df, rel_form_ls, rel_visit_ls)
    add_df = ${filterFunc}(add_df,['${form3}'],[])
    if len(prim_df)>0 and len(add_df)>0:
        prim_df = prim_df[(~prim_df['${filterCol}'].isin(null_values))]
        add_df = add_df[add_df['${enrollCol}']=='${enrollVal}']
        if len(prim_df)>0  and len(add_df)>0:
            prim_df = prim_df.sort_values(by='SPID', ascending=True).drop_duplicates(subset=['SUBJID','VISIT','${filterCol}'],keep='first').sort_index().reset_index(drop=True)
            for prim_ind in prim_df.index.tolist():
                prim_rec = prim_df.loc[[prim_ind]]
                query_text = ${queryFunc}(query_text)
                prim_visit = prim_rec['VISIT'].values[0]
                flag = False
                if len(rel_df)>0:
                    new_df = rel_df[(rel_df['VISIT']==prim_rec['VISIT'].values[0])]
                    if len(new_df)==0:
                        flag = True
                else:
                    flag = True
                if flag:
                    payload = {
                        "query_text": query_text, #Update the query text here
                        "form_index": str(prim_rec['form_index'].values[0]),
                        "modif_dts": str(pd.to_datetime(prim_rec['modif_dts'].values[0])),
                        "stg_ck_event_id": int(prim_rec['ck_event_id']),
                        "relational_ck_event_ids": [],
                        "confid_score": 1,
                            }
                    payload_records.append(payload)
    return payload_records
            `;
            
            // Display the code
            const codeOutput = document.getElementById('dov-code-output');
            document.getElementById('dov-code-content').textContent = code;
            codeOutput.classList.remove('hidden');
        }
        
        function generateDateNeCode() {
            // Get user inputs
            const ruleName = document.getElementById('date-ne-rule-name').value;
            const domain1 = document.getElementById('date-ne-domain1').value;
            const domain2 = document.getElementById('date-ne-domain2').value;
            const primForm = document.getElementById('date-ne-prim-form').value;
            const primVisit = processCommaSeparatedInput(document.getElementById('date-ne-prim-visit').value);
            const relForm = document.getElementById('date-ne-rel-form').value;
            const primDateCol = document.getElementById('date-ne-prim-date-col').value;
            const relDateCol = document.getElementById('date-ne-rel-date-col').value;
            
            // Get filter function
            let filterFunc;
            const filterFuncSelect = document.getElementById('date-ne-filter-func');
            if (filterFuncSelect.value === 'other') {
                filterFunc = document.getElementById('date-ne-filter-func-custom').value;
            } else {
                filterFunc = filterFuncSelect.value;
            }
            
            // Get query function
            let queryFunc;
            const queryFuncSelect = document.getElementById('date-ne-query-func');
            if (queryFuncSelect.value === 'other') {
                queryFunc = document.getElementById('date-ne-query-func-custom').value;
            } else {
                queryFunc = queryFuncSelect.value;
            }
            
            // Generate the code
            const code = `
"""
Rule Name: ${ruleName}
Domains: ${domain2}, ${domain1}
"""

def ${ruleName}(query_text, ${domain2}, ${domain1}):
    payload_records = []
    prim_df = ${domain1}.copy()
    rel_df = ${domain2}.copy()
    if prim_df.shape[0] > 0 and rel_df.shape[0]>0:
        args_dict = {
            'p_form_ls': ['${primForm}'],
            'p_visit_ls': [${primVisit}]
        } 
        p_form_ls = args_dict['p_form_ls']
        p_visit_ls = args_dict['p_visit_ls']
        null_values = ['null', 'Null', 'NULL', 'NaN', '', ' ', 'None', 'NaT', 'np.nan', 'nan', None, np.nan]
        prim_df = ${filterFunc}(prim_df,p_form_ls,p_visit_ls)
        rel_df = ${filterFunc}(rel_df,['${relForm}'],p_visit_ls)
        if len(prim_df) > 0 and len(rel_df)>0:
            prim_df = prim_df[(~prim_df['${primDateCol}'].isin(null_values))]
            rel_df = rel_df[(~rel_df['${relDateCol}'].isin(null_values))]
            if len(prim_df) > 0 and len(rel_df)>0:
                prim_df['${primDateCol}'] = prim_df['${primDateCol}'].apply(udf_glbl_get_date)
                rel_df['${relDateCol}'] = rel_df['${relDateCol}'].apply(udf_glbl_get_date)
                if len(prim_df)>0 and len(rel_df)>0:
                    prim_df = prim_df.sort_values(by='SPID', ascending=True).drop_duplicates(subset=['SUBJID','VISIT','${primDateCol}'],keep='first').sort_index().reset_index(drop=True) 
                    for p_ind in range(prim_df.shape[0]):
                        prim_rec = prim_df.iloc[[p_ind]]
                        query_text = ${queryFunc}(query_text)
                        rel_df1 = rel_df[rel_df['VISIT']==prim_rec['VISIT'].values[0]]
                        if len(rel_df1)>0:
                            for s_ind in range(rel_df1.shape[0]):
                                s_rec = rel_df1.iloc[[s_ind]]
                                if prim_rec['${primDateCol}'].values[0]!=s_rec['${relDateCol}'].values[0]:
                                    payload = {
                                        "query_text":query_text%(str(prim_rec['${primDateCol}'].values[0]).split('T')[0],str(s_rec['${relDateCol}'].values[0]).split('T')[0]),  # Update the query text here
                                        "form_index": str(prim_rec['form_index'].values[0]),
                                        "modif_dts": str(pd.to_datetime(prim_rec['modif_dts'].values[0])),
                                        "stg_ck_event_id": int(prim_rec['ck_event_id']),
                                        "relational_ck_event_ids": [int(s_rec['ck_event_id'].values[0])],
                                        "confid_score": 1,
                                        }
                                    payload_records.append(payload)				
    return payload_records
            `;
            
            // Display the code
            const codeOutput = document.getElementById('date-ne-code-output');
            document.getElementById('date-ne-code-content').textContent = code;
            codeOutput.classList.remove('hidden');
        }
        
        function generateCc1Code() {
            // Get user inputs
            const ruleName = document.getElementById('cc1-rule-name').value;
            const domain = document.getElementById('cc1-domain').value;
            const form = document.getElementById('cc1-form').value;
            const visit = processCommaSeparatedInput(document.getElementById('cc1-visit').value);
            const dupCol = document.getElementById('cc1-dup-col').value;
            const subsetCol = processCommaSeparatedInput(document.getElementById('cc1-subset-col').value);
            
            // Get filter function
            let filterFunc;
            const filterFuncSelect = document.getElementById('cc1-filter-func');
            if (filterFuncSelect.value === 'other') {
                filterFunc = document.getElementById('cc1-filter-func-custom').value;
            } else {
                filterFunc = filterFuncSelect.value;
            }
            
            // Get query function
            let queryFunc;
            const queryFuncSelect = document.getElementById('cc1-query-func');
            if (queryFuncSelect.value === 'other') {
                queryFunc = document.getElementById('cc1-query-func-custom').value;
            } else {
                queryFunc = queryFuncSelect.value;
            }
            
            // Generate the code
            const code = `
"""
Rule Name: ${ruleName}
Domain: ${domain}
"""

def ${ruleName}(query_text, ${domain}):
    payload_records = []
    prim_df = ${domain}.copy()
    if prim_df.shape[0] > 0:
        args_dict = {
            'p_form_ls': ['${form}'],
            'p_visit_ls': [${visit}],
        }
        p_form_ls = args_dict['p_form_ls']
        p_visit_ls = args_dict['p_visit_ls']
        null_values = ['null', 'Null', 'NULL', 'NaN', '', ' ', 'None', 'NaT', 'np.nan', 'nan', None, np.nan]
        prim_df = ${filterFunc}(prim_df,p_form_ls,p_visit_ls)
        if len(prim_df) > 0:
            prim_df = prim_df[prim_df.duplicated(subset=['${dupCol}'],keep=False)]
            if len(prim_df) > 0:
                    prim_df = prim_df.sort_values(by='SPID', ascending=True).drop_duplicates(subset=[${subsetCol}],keep='first').sort_index().reset_index(drop=True) 
                    for p_ind in range(prim_df.shape[0]):
                        prim_rec = prim_df.iloc[[p_ind]]
                        query_text = ${queryFunc}(query_text)
                        payload = {
                                "query_text":query_text,  # Update the query text here
                                "form_index": str(prim_rec['form_index'].values[0]),
                                "modif_dts": str(pd.to_datetime(prim_rec['modif_dts'].values[0])),
                                "stg_ck_event_id": int(prim_rec['ck_event_id']),
                                "relational_ck_event_ids": [],
                                "confid_score": 1,
                                }
                        payload_records.append(payload)				
    return payload_records
            `;
            
            // Display the code
            const codeOutput = document.getElementById('cc1-code-output');
            document.getElementById('cc1-code-content').textContent = code;
            codeOutput.classList.remove('hidden');
        }
        
        function generateSaeCode() {
            const ruleName = document.getElementById('sae-rule-name').value;
            const domain1 = document.getElementById('sae-domain1').value;
            const domain2 = document.getElementById('sae-domain2').value;
            const triggerCol = document.getElementById('sae-trigger-col').value;
            const expectedVal = document.getElementById('sae-expected-val').value;
            
            const code = `
"""
Rule Name: ${ruleName}
Domains: ${domain1}, ${domain2}
Trigger Column: ${triggerCol}
Expected Value: ${expectedVal}
"""

def ${ruleName}(query_text, ${domain1}, ${domain2}):
    payload_records = []
    prim_df = ${domain1}.copy()
    rel_df = ${domain2}.copy()
    
    null_values = ['null', 'Null', 'NULL', 'NaN', '', ' ', 'None', 'NaT', 'np.nan', 'nan', None, np.nan]
    
    # Find records where trigger column has the expected value
    prim_df = prim_df[prim_df['${triggerCol}'].astype(str).str.upper() == '${expectedVal}'.upper()]
    
    if len(prim_df) > 0:
        for prim_ind in prim_df.index.tolist():
            prim_rec = prim_df.loc[[prim_ind]]
            query_text = f"SAE trigger check failed for subject {prim_rec['SPID'].values[0]}"
            payload = {
                    "query_text": query_text,
                    "form_index": str(prim_rec['form_index'].values[0]),
                    "modif_dts": str(pd.to_datetime(prim_rec['modif_dts'].values[0])),
                    "stg_ck_event_id": int(prim_rec['ck_event_id']),
                    "relational_ck_event_ids": [],
                    "confid_score": 1,
                        }
            payload_records.append(payload)

    return payload_records
            `;
            
            document.getElementById('sae-code-content').textContent = code;
            document.getElementById('sae-code-output').classList.remove('hidden');
        }
        
        function generateFormCode() {
            const ruleName = document.getElementById('form-rule-name').value;
            const domain = document.getElementById('form-domain').value;
            const expectedForms = processCommaSeparatedInput(document.getElementById('form-expected').value);
            const visitCol = document.getElementById('form-visit-col').value;
            
            const code = `
"""
Rule Name: ${ruleName}
Domain: ${domain}
Expected Forms: ${expectedForms}
"""

def ${ruleName}(query_text, ${domain}):
    payload_records = []
    df = ${domain}.copy()
    
    # Get unique visits in the data
    visits = df['${visitCol}'].unique()
    
    for visit in visits:
        # Get forms present for this visit
        present_forms = df[df['${visitCol}'] == visit]['formname'].unique()
        
        # Check for missing forms
        expected_forms = [${expectedForms}]
        missing_forms = [f for f in expected_forms if f not in present_forms]
        
        if missing_forms:
            query_text = f"Missing forms {', '.join(missing_forms)} for visit {visit}"
            payload = {
                    "query_text": query_text,
                    "form_index": "N/A",
                    "modif_dts": str(pd.to_datetime('now')),
                    "stg_ck_event_id": -1,
                    "relational_ck_event_ids": [],
                    "confid_score": 1,
                        }
            payload_records.append(payload)

    return payload_records
            `;
            
            document.getElementById('form-code-content').textContent = code;
            document.getElementById('form-code-output').classList.remove('hidden');
        }
        
        function generateGtCode() {
            const ruleName = document.getElementById('gt-rule-name').value;
            const domain = document.getElementById('gt-domain').value;
            const col1 = document.getElementById('gt-col1').value;
            const col2 = document.getElementById('gt-col2').value;
            
            const code = `
"""
Rule Name: ${ruleName}
Domain: ${domain}
Columns: ${col1} > ${col2}
"""

def ${ruleName}(query_text, ${domain}):
    payload_records = []
    df = ${domain}.copy()
    
    # Convert to numeric
    df['${col1}_num'] = pd.to_numeric(df['${col1}'], errors='coerce')
    df['${col2}_num'] = pd.to_numeric(df['${col2}'], errors='coerce')
    
    # Find records where ${col1} > ${col2}
    mismatch_df = df[df['${col1}_num'] > df['${col2}_num']]
    
    if len(mismatch_df) > 0:
        for idx in mismatch_df.index.tolist():
            rec = mismatch_df.loc[[idx]]
            query_text = f"Value check failed: ${col1} ({rec['${col1}'].values[0]}) > ${col2} ({rec['${col2}'].values[0]})"
            payload = {
                    "query_text": query_text,
                    "form_index": str(rec['form_index'].values[0]),
                    "modif_dts": str(pd.to_datetime(rec['modif_dts'].values[0])),
                    "stg_ck_event_id": int(rec['ck_event_id']),
                    "relational_ck_event_ids": [],
                    "confid_score": 1,
                        }
            payload_records.append(payload)

    return payload_records
            `;
            
            document.getElementById('gt-code-content').textContent = code;
            document.getElementById('gt-code-output').classList.remove('hidden');
        }
        
        function generateLtCode() {
            const ruleName = document.getElementById('lt-rule-name').value;
            const domain = document.getElementById('lt-domain').value;
            const col1 = document.getElementById('lt-col1').value;
            const col2 = document.getElementById('lt-col2').value;
            
            const code = `
"""
Rule Name: ${ruleName}
Domain: ${domain}
Columns: ${col1} < ${col2}
"""

def ${ruleName}(query_text, ${domain}):
    payload_records = []
    df = ${domain}.copy()
    
    # Convert to numeric
    df['${col1}_num'] = pd.to_numeric(df['${col1}'], errors='coerce')
    df['${col2}_num'] = pd.to_numeric(df['${col2}'], errors='coerce')
    
    # Find records where ${col1} < ${col2}
    mismatch_df = df[df['${col1}_num'] < df['${col2}_num']]
    
    if len(mismatch_df) > 0:
        for idx in mismatch_df.index.tolist():
            rec = mismatch_df.loc[[idx]]
            query_text = f"Value check failed: ${col1} ({rec['${col1}'].values[0]}) < ${col2} ({rec['${col2}'].values[0]})"
            payload = {
                    "query_text": query_text,
                    "form_index": str(rec['form_index'].values[0]),
                    "modif_dts": str(pd.to_datetime(rec['modif_dts'].values[0])),
                    "stg_ck_event_id": int(rec['ck_event_id']),
                    "relational_ck_event_ids": [],
                    "confid_score": 1,
                        }
            payload_records.append(payload)

    return payload_records
            `;
            
            document.getElementById('lt-code-content').textContent = code;
            document.getElementById('lt-code-output').classList.remove('hidden');
        }
        
        function generateSiCode() {
            const ruleName = document.getElementById('si-rule-name').value;
            const domain = document.getElementById('si-domain').value;
            const valueCol = document.getElementById('si-value-col').value;
            const unitCol = document.getElementById('si-unit-col').value;
            const expectedUnits = processCommaSeparatedInput(document.getElementById('si-expected').value);
            
            const code = `
"""
Rule Name: ${ruleName}
Domain: ${domain}
Value Column: ${valueCol}
Unit Column: ${unitCol}
Expected SI Units: ${expectedUnits}
"""

def ${ruleName}(query_text, ${domain}):
    payload_records = []
    df = ${domain}.copy()
    
    # Convert units to uppercase for comparison
    df['unit_upper'] = df['${unitCol}'].astype(str).str.upper()
    
    # Define expected SI units
    expected_si_units = [${expectedUnits}]
    
    # Find records with non-SI units
    non_si_df = df[~df['unit_upper'].isin(expected_si_units)]
    
    if len(non_si_df) > 0:
        for idx in non_si_df.index.tolist():
            rec = non_si_df.loc[[idx]]
            query_text = f"Non-SI unit found: {rec['${unitCol}'].values[0]} for value {rec['${valueCol}'].values[0]}"
            payload = {
                    "query_text": query_text,
                    "form_index": str(rec['form_index'].values[0]),
                    "modif_dts": str(pd.to_datetime(rec['modif_dts'].values[0])),
                    "stg_ck_event_id": int(rec['ck_event_id']),
                    "relational_ck_event_ids": [],
                    "confid_score": 1,
                        }
            payload_records.append(payload)

    return payload_records
            `;
            
            document.getElementById('si-code-content').textContent = code;
            document.getElementById('si-code-output').classList.remove('hidden');
        }
        
        function generateUsCode() {
            const ruleName = document.getElementById('us-rule-name').value;
            const domain = document.getElementById('us-domain').value;
            const valueCol = document.getElementById('us-value-col').value;
            const unitCol = document.getElementById('us-unit-col').value;
            const expectedUnits = processCommaSeparatedInput(document.getElementById('us-expected').value);
            
            const code = `
"""
Rule Name: ${ruleName}
Domain: ${domain}
Value Column: ${valueCol}
Unit Column: ${unitCol}
Expected US Units: ${expectedUnits}
"""

def ${ruleName}(query_text, ${domain}):
    payload_records = []
    df = ${domain}.copy()
    
    # Convert units to uppercase for comparison
    df['unit_upper'] = df['${unitCol}'].astype(str).str.upper()
    
    # Define expected US units
    expected_us_units = [${expectedUnits}]
    
    # Find records with non-US units
    non_us_df = df[~df['unit_upper'].isin(expected_us_units)]
    
    if len(non_us_df) > 0:
        for idx in non_us_df.index.tolist():
            rec = non_us_df.loc[[idx]]
            query_text = f"Non-US unit found: {rec['${unitCol}'].values[0]} for value {rec['${valueCol}'].values[0]}"
            payload = {
                    "query_text": query_text,
                    "form_index": str(rec['form_index'].values[0]),
                    "modif_dts": str(pd.to_datetime(rec['modif_dts'].values[0])),
                    "stg_ck_event_id": int(rec['ck_event_id']),
                    "relational_ck_event_ids": [],
                    "confid_score": 1,
                        }
            payload_records.append(payload)

    return payload_records
            `;
            
            document.getElementById('us-code-content').textContent = code;
            document.getElementById('us-code-output').classList.remove('hidden');
        }

                function handleFormFilterFuncChange() {
            const select = document.getElementById('form-filter-func');
            const customInput = document.getElementById('form-filter-func-custom');
            
            if (select.value === 'other') {
                customInput.classList.remove('hidden');
                customInput.value = '';
                customInput.required = true;
            } else {
                customInput.classList.add('hidden');
                customInput.required = false;
            }
        }
        
        function handleFormQueryFuncChange() {
            const select = document.getElementById('form-query-func');
            const customInput = document.getElementById('form-query-func-custom');
            
            if (select.value === 'other') {
                customInput.classList.remove('hidden');
                customInput.value = '';
                customInput.required = true;
            } else {
                customInput.classList.add('hidden');
                customInput.required = false;
            }
        }
        
        function clearFormInputs() {
            document.getElementById('form-rule-name').value = '';
            document.getElementById('form-domain1').value = '';
            document.getElementById('form-domain2').value = '';
            document.getElementById('form-domain3').value = '';
            document.getElementById('form-form1').value = '';
            document.getElementById('form-visit1').value = '';
            document.getElementById('form-var1').value = '';
            document.getElementById('form-var2').value = '';
            document.getElementById('form-days').value = '';
            document.getElementById('form-filter-func').value = 'udf_glbl_filter_by_form_visit';
            document.getElementById('form-filter-func-custom').value = '';
            document.getElementById('form-filter-func-custom').classList.add('hidden');
            document.getElementById('form-query-func').value = 'udf_glbl_update_querytext';
            document.getElementById('form-query-func-custom').value = '';
            document.getElementById('form-query-func-custom').classList.add('hidden');
            document.getElementById('form-date-func1').value = 'udf_glbl_get_date';
            document.getElementById('form-date-func2').value = 'udf_glbl_get_date';
            document.getElementById('form-comp-func').value = 'udf_glbl_compare_dates';
            document.getElementById('form-code-output').classList.add('hidden');
            
            clearErrors('form-');
        }
        
        function validateAndGenerateFormCode() {
            if (validateInputs('form-')) {
                generateFormCode();
            }
        }
        
        function generateFormCode() {
            // Get user inputs
            const ruleName = document.getElementById('form-rule-name').value;
            const domain1 = document.getElementById('form-domain1').value;
            const domain2 = document.getElementById('form-domain2').value;
            const domain3 = document.getElementById('form-domain3').value;
            const form1 = document.getElementById('form-form1').value;
            const visit1 = processCommaSeparatedInput(document.getElementById('form-visit1').value);
            const var1 = document.getElementById('form-var1').value;
            const var2 = document.getElementById('form-var2').value;
            const days = document.getElementById('form-days').value;
            
            // Get filter function
            let filterFunc;
            const filterFuncSelect = document.getElementById('form-filter-func');
            if (filterFuncSelect.value === 'other') {
                filterFunc = document.getElementById('form-filter-func-custom').value;
            } else {
                filterFunc = filterFuncSelect.value;
            }
            
            // Get query function
            let queryFunc;
            const queryFuncSelect = document.getElementById('form-query-func');
            if (queryFuncSelect.value === 'other') {
                queryFunc = document.getElementById('form-query-func-custom').value;
            } else {
                queryFunc = queryFuncSelect.value;
            }
            
            const dateFunc1 = document.getElementById('form-date-func1').value;
            const dateFunc2 = document.getElementById('form-date-func2').value;
            const compFunc = document.getElementById('form-comp-func').value;
            
            // Generate the code
            const code = `
"""
Rule Name: ${ruleName}
Domains: ${domain1}, ${domain3}, ${domain2}
"""

def ${ruleName}(query_text, ${domain1}, ${domain3}, ${domain2}):
    payload_records = []
    prim_df = ${domain1}.copy()
    rel_df = ${domain2}.copy()
    ter_df = ${domain3}.copy()
    
    if prim_df.shape[0] > 0 and rel_df.shape[0] > 0:
        args_dict = {
            'p_form_ls': ['${form1}'],
            'p_visit_ls': [${visit1}],
            'p_var': '${var1}',
            's_var': '${var2}',
            'add_days': ${days}
        }
        
        p_form_ls = args_dict['p_form_ls']
        p_visit_ls = args_dict['p_visit_ls']
        p_dcmdate, s_currdtc, add_days = args_dict['p_var'], args_dict['s_var'], args_dict['add_days']
        prim_df = ${filterFunc}(prim_df, p_form_ls, p_visit_ls)
        query_text = ${queryFunc}(query_text)
        p_flag, prim_df = ${compFunc}(prim_df, p_dcmdate, '!=')
        s_flag, rel_df = ${compFunc}(rel_df, s_currdtc, '!=')
        
        if p_flag and s_flag:
            prim_df[p_dcmdate] = pd.to_datetime(prim_df[p_dcmdate].apply(${dateFunc1}))
            rel_df[s_currdtc] = pd.to_datetime(rel_df[s_currdtc].apply(${dateFunc2}))
            prim_df = prim_df.sort_values(by='SPID', ascending=True).drop_duplicates(subset=['visit_id'], keep='first').sort_index().reset_index(drop=True)
            
            for prim_ind in range(prim_df.shape[0]):
                prim_rec = prim_df.iloc[[prim_ind]]
                prim_visit = prim_rec['visit_id'].values[0]
                dcmdate = prim_rec[p_dcmdate].values[0] + pd.Timedelta(days=add_days)
                
                r_flag, rel_df_f = ${compFunc}(rel_df, s_currdtc, dcmdate, '>')
                ter_df_f = ${filterFunc}(ter_df, [], [prim_visit])
                
                if r_flag and len(ter_df_f) == 0:
                    ck_event = []
                    rel_df = rel_df.sort_values(by='SPID', ascending=True)
                    ck_event.append(int(rel_df['ck_event_id'].values[0]))
                    
                    payload = {
                        "query_text": query_text % (prim_rec['visit_nm'].values[0]),  # Update the query text here
                        "form_index": str(prim_rec['form_index'].values[0]),
                        "modif_dts": str(pd.to_datetime(prim_rec['modif_dts'].values[0])),
                        "stg_ck_event_id": int(prim_rec['ck_event_id']),
                        "relational_ck_event_ids": ck_event,
                        "confid_score": 1,
                    }
                    payload_records.append(payload)    
    return payload_records
            `;
            
            document.getElementById('form-code-content').textContent = code;
            document.getElementById('form-code-output').classList.remove('hidden');
        }
        function handleSaeFilterFuncChange() {
    const select = document.getElementById('sae-filter-func');
    const customInput = document.getElementById('sae-filter-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function handleSaeQueryFuncChange() {
    const select = document.getElementById('sae-query-func');
    const customInput = document.getElementById('sae-query-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function clearSaeInputs() {
    document.getElementById('sae-rule-name').value = '';
    document.getElementById('sae-domain1').value = '';
    document.getElementById('sae-domain2').value = '';
    document.getElementById('sae-form1').value = '';
    document.getElementById('sae-visit1').value = '';
    document.getElementById('sae-form2').value = '';
    document.getElementById('sae-visit2').value = '';
    document.getElementById('sae-trigger-col').value = '';
    document.getElementById('sae-trigger-val').value = '';
    document.getElementById('sae-filter-func').value = 'udf_glbl_filter_by_form_visit';
    document.getElementById('sae-filter-func-custom').value = '';
    document.getElementById('sae-filter-func-custom').classList.add('hidden');
    document.getElementById('sae-query-func').value = 'udf_glbl_update_querytext';
    document.getElementById('sae-query-func-custom').value = '';
    document.getElementById('sae-query-func-custom').classList.add('hidden');
    document.getElementById('sae-code-output').classList.add('hidden');
    
    clearErrors('sae-');
}

function generateSaeCode() {
    // Get user inputs
    const ruleName = document.getElementById('sae-rule-name').value;
    const domain1 = document.getElementById('sae-domain1').value;
    const domain2 = document.getElementById('sae-domain2').value;
    const form1 = document.getElementById('sae-form1').value;
    const visit1 = processCommaSeparatedInput(document.getElementById('sae-visit1').value);
    const form2 = processCommaSeparatedInput(document.getElementById('sae-form2').value);
    const visit2 = processCommaSeparatedInput(document.getElementById('sae-visit2').value);
    const triggerCol = document.getElementById('sae-trigger-col').value;
    const triggerVal = document.getElementById('sae-trigger-val').value;
    
    // Get filter function
    let filterFunc;
    const filterFuncSelect = document.getElementById('sae-filter-func');
    if (filterFuncSelect.value === 'other') {
        filterFunc = document.getElementById('sae-filter-func-custom').value;
    } else {
        filterFunc = filterFuncSelect.value;
    }
    
    // Get query function
    let queryFunc;
    const queryFuncSelect = document.getElementById('sae-query-func');
    if (queryFuncSelect.value === 'other') {
        queryFunc = document.getElementById('sae-query-func-custom').value;
    } else {
        queryFunc = queryFuncSelect.value;
    }
    
    // Generate the code
    const code = `
"""
Rule Name: ${ruleName}
Domains: ${domain1}, ${domain2}
"""

def ${ruleName}(query_text, ${domain1}, ${domain2}):
    payload_records = []
    prim_df = ${domain1}.copy()
    rel_df = ${domain2}.copy()
    args_dict = {
        'prim_form_ls' : ['${form1}'],
        'prim_visit_ls' : [${visit1}],
        'rel_form_ls' : [${form2}],
        'rel_visit_ls' : [${visit2}],
        'null_values': ['null', 'Null', 'NULL', 'NaN', '', ' ', 'None', 'NaT', 'np.nan', 'nan', None, np.nan]
    }
    prim_form_ls, prim_visit_ls = args_dict['prim_form_ls'], args_dict['prim_visit_ls']
    rel_form_ls, rel_visit_ls = args_dict['rel_form_ls'], args_dict['rel_visit_ls']
    null_values = args_dict['null_values']
    prim_df = ${filterFunc}(prim_df, prim_form_ls, prim_visit_ls)
    rel_df = ${filterFunc}(rel_df, rel_form_ls, rel_visit_ls)

    if len(prim_df)>0 :
        prim_df = prim_df[(prim_df['${triggerCol}'].isin(['${triggerVal}']))]
        if len(prim_df)>0  and len(rel_df)==0:
            prim_df = prim_df.sort_values(by='SPID', ascending=True).drop_duplicates(subset=['SUBJID','VISIT','${triggerCol}'],keep='first').sort_index().reset_index(drop=True)
            for prim_ind in prim_df.index.tolist():
                prim_rec = prim_df.loc[[prim_ind]]
                query_text = ${queryFunc}(query_text)
                payload = {
                        "query_text": query_text, #Update the query text here
                        "form_index": str(prim_rec['form_index'].values[0]),
                        "modif_dts": str(pd.to_datetime(prim_rec['modif_dts'].values[0])),
                        "stg_ck_event_id": int(prim_rec['ck_event_id']),
                        "relational_ck_event_ids": [],
                        "confid_score": 1,
                            }
                payload_records.append(payload)                
    return payload_records
    `;
    
    document.getElementById('sae-code-content').textContent = code;
    document.getElementById('sae-code-output').classList.remove('hidden');
}

function handleGtFilterFuncChange() {
    const select = document.getElementById('gt-filter-func');
    const customInput = document.getElementById('gt-filter-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function handleGtQueryFuncChange() {
    const select = document.getElementById('gt-query-func');
    const customInput = document.getElementById('gt-query-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function clearGtInputs() {
    document.getElementById('gt-rule-name').value = '';
    document.getElementById('gt-domain1').value = '';
    document.getElementById('gt-domain2').value = '';
    document.getElementById('gt-form1').value = '';
    document.getElementById('gt-visit1').value = '';
    document.getElementById('gt-form2').value = '';
    document.getElementById('gt-visit2').value = '';
    document.getElementById('gt-prim-date-col').value = '';
    document.getElementById('gt-rel-date-col').value = '';
    document.getElementById('gt-filter-func').value = 'udf_glbl_filter_by_form_visit';
    document.getElementById('gt-filter-func-custom').value = '';
    document.getElementById('gt-filter-func-custom').classList.add('hidden');
    document.getElementById('gt-null-check-func').value = 'udf_glbl_compare_dates';
    document.getElementById('gt-date-func').value = 'udf_glbl_get_date';
    document.getElementById('gt-comp-func').value = 'udf_glbl_compare_dates';
    document.getElementById('gt-query-func').value = 'udf_glbl_update_querytext';
    document.getElementById('gt-query-func-custom').value = '';
    document.getElementById('gt-query-func-custom').classList.add('hidden');
    document.getElementById('gt-code-output').classList.add('hidden');
    
    clearErrors('gt-');
}

function generateGtCode() {
    // Get user inputs
    const ruleName = document.getElementById('gt-rule-name').value;
    const domain1 = document.getElementById('gt-domain1').value;
    const domain2 = document.getElementById('gt-domain2').value;
    const form1 = document.getElementById('gt-form1').value;
    const visit1 = processCommaSeparatedInput(document.getElementById('gt-visit1').value);
    const form2 = document.getElementById('gt-form2').value;
    const visit2 = processCommaSeparatedInput(document.getElementById('gt-visit2').value);
    const primDateCol = document.getElementById('gt-prim-date-col').value;
    const relDateCol = document.getElementById('gt-rel-date-col').value;
    
    // Get filter function
    let filterFunc;
    const filterFuncSelect = document.getElementById('gt-filter-func');
    if (filterFuncSelect.value === 'other') {
        filterFunc = document.getElementById('gt-filter-func-custom').value;
    } else {
        filterFunc = filterFuncSelect.value;
    }
    
    // Get query function
    let queryFunc;
    const queryFuncSelect = document.getElementById('gt-query-func');
    if (queryFuncSelect.value === 'other') {
        queryFunc = document.getElementById('gt-query-func-custom').value;
    } else {
        queryFunc = queryFuncSelect.value;
    }
    
    const nullCheckFunc = document.getElementById('gt-null-check-func').value;
    const dateFunc = document.getElementById('gt-date-func').value;
    const compFunc = document.getElementById('gt-comp-func').value;
    
    // Generate the code
    const code = `
"""
Rule Name: ${ruleName}
Domains: ${domain1}, ${domain2}
"""

def ${ruleName}(query_text, ${domain1}, ${domain2}):
    payload_records = []
    prim_df = ${domain1}.copy()
    rel_df = ${domain2}.copy()
    if prim_df.shape[0] > 0:
        args_dict = {
            'p_form_ls': ['${form1}'],
            'p_visit_ls': [${visit1}],
            's_form_ls': ['${form2}'],
            's_visit_ls': [${visit2}],
            'p_var': '${primDateCol}',
            's_var': '${relDateCol}'
        }
        p_form_ls = args_dict['p_form_ls']
        p_visit_ls = args_dict['p_visit_ls']
        s_form_ls = args_dict['s_form_ls']
        s_visit_ls = args_dict['s_visit_ls']
        p_var, s_var = args_dict['p_var'],args_dict['s_var']
        null_values = ['null', 'Null', 'NULL', 'NaN', '', ' ', 'None', 'NaT', 'np.nan', 'nan', None, np.nan]
        prim_df = ${filterFunc}(prim_df,p_form_ls,p_visit_ls)
        rel_df = ${filterFunc}(rel_df,s_form_ls,s_visit_ls)
        if len(prim_df) > 0 and len(rel_df)>0:
            p_flag, prim_df = ${nullCheckFunc}(prim_df, p_var, '!=')
            rel_df = rel_df[(~rel_df['${relDateCol}'].isin(null_values))]
            if len(prim_df) > 0 and len(rel_df)>0:
                prim_df[p_var]=prim_df[p_var].apply(${dateFunc})
                prim_df = prim_df.dropna(subset=[p_var], how='all')
                rel_df[s_var]=rel_df[s_var].apply(${dateFunc})
                rel_df = rel_df.dropna(subset=[s_var], how='all')
                if len(prim_df)>0 and len(rel_df)>0:
                    prim_df = prim_df.sort_values(by='SPID', ascending=True).drop_duplicates(subset=['SUBJID','VISIT',p_var],keep='first').sort_index().reset_index(drop=True)
                    rel_df = rel_df.sort_values(by='SPID', ascending=True).drop_duplicates(subset=['SUBJID','VISIT',s_var],keep='first').sort_index().reset_index(drop=True) 
                    for p_ind in range(prim_df.shape[0]):
                        prim_rec = prim_df.iloc[[p_ind]]
                        n_flag, new_df = ${compFunc}(rel_df, s_var, prim_rec[p_var].values[0],'<')
                        if len(new_df)>0 and n_flag:
                                query_text = ${queryFunc}(query_text)
                                payload = {
                                "query_text":query_text,  # Update the query text here
                                "form_index": str(prim_rec['form_index'].values[0]),
                                "modif_dts": str(pd.to_datetime(prim_rec['modif_dts'].values[0])),
                                "stg_ck_event_id": int(prim_rec['ck_event_id']),
                                "relational_ck_event_ids": [],
                                "confid_score": 1,
                                }
                                payload_records.append(payload)                
    return payload_records
    `;
    
    document.getElementById('gt-code-content').textContent = code;
    document.getElementById('gt-code-output').classList.remove('hidden');
}

function handleDsFilterFuncChange() {
    const select = document.getElementById('ds-filter-func');
    const customInput = document.getElementById('ds-filter-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function handleDsQueryFuncChange() {
    const select = document.getElementById('ds-query-func');
    const customInput = document.getElementById('ds-query-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function clearDsInputs() {
    document.getElementById('ds-rule-name').value = '';
    document.getElementById('ds-domain1').value = 'DS';
    document.getElementById('ds-form1').value = '';
    document.getElementById('ds-form2').value = '';
    document.getElementById('ds-filter-func').value = 'udf_glbl_filter_by_form_visit';
    document.getElementById('ds-filter-func-custom').value = '';
    document.getElementById('ds-filter-func-custom').classList.add('hidden');
    document.getElementById('ds-query-func').value = 'udf_glbl_update_querytext';
    document.getElementById('ds-query-func-custom').value = '';
    document.getElementById('ds-query-func-custom').classList.add('hidden');
    document.getElementById('ds-code-output').classList.add('hidden');
    
    clearErrors('ds-');
}

function validateAndGenerateDsCode() {
    if (validateInputs('ds-')) {
        generateDsCode();
    }
}

function generateDsCode() {
    // Get user inputs
    const ruleName = document.getElementById('ds-rule-name').value;
    const domain1 = document.getElementById('ds-domain1').value;
    const form1 = document.getElementById('ds-form1').value;
    const form2 = document.getElementById('ds-form2').value;
    
    // Get filter function
    let filterFunc;
    const filterFuncSelect = document.getElementById('ds-filter-func');
    if (filterFuncSelect.value === 'other') {
        filterFunc = document.getElementById('ds-filter-func-custom').value;
    } else {
        filterFunc = filterFuncSelect.value;
    }
    
    // Get query function
    let queryFunc;
    const queryFuncSelect = document.getElementById('ds-query-func');
    if (queryFuncSelect.value === 'other') {
        queryFunc = document.getElementById('ds-query-func-custom').value;
    } else {
        queryFunc = queryFuncSelect.value;
    }
    
    // Generate the code
    const code = `
"""
Rule Name: ${ruleName}
Domains: ${domain1}
"""

def ${ruleName}(query_text, ${domain1}):
    payload_records = []
    prim_df = ${domain1}.copy()
    rel_df = ${domain1}.copy()

    if prim_df.shape[0] > 0 :
        prim_df = ${filterFunc}(prim_df, ['${form1}'], [])
        rel_df = ${filterFunc}(rel_df,['${form2}'],[])
        if len(prim_df) > 0 :
            prim_df = prim_df[~prim_df['DSDECOD'].isin(['null', 'Null', 'NULL', 'NaN', '', ' ', 'None', 'NaT', 'np.nan', 'nan', None, np.nan])]
            if len(prim_df)>0 and len(rel_df)==0:
                prim_df = prim_df.sort_values(by='SPID', ascending=True).drop_duplicates(subset=['SUBJID','VISIT'],keep='first').sort_index().reset_index(drop=True) 
                for prim_ind in range(prim_df.shape[0]):
                    prim_rec = prim_df.iloc[[prim_ind]]
                    query_text = ${queryFunc}(query_text)
                    payload = {
                        "query_text": query_text,  # Update the query text here
                        "form_index": str(prim_rec['form_index'].values[0]),
                        "modif_dts": str(pd.to_datetime(prim_rec['modif_dts'].values[0])),
                        "stg_ck_event_id": int(prim_rec['ck_event_id']),
                        "relational_ck_event_ids": [],
                        "confid_score": 1,
                        }
                    payload_records.append(payload)
    return payload_records
    `;
    
    document.getElementById('ds-code-content').textContent = code;
    document.getElementById('ds-code-output').classList.remove('hidden');
}

function handleLtFilterFuncChange() {
    const select = document.getElementById('lt-filter-func');
    const customInput = document.getElementById('lt-filter-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function handleLtQueryFuncChange() {
    const select = document.getElementById('lt-query-func');
    const customInput = document.getElementById('lt-query-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function clearLtInputs() {
    document.getElementById('lt-rule-name').value = '';
    document.getElementById('lt-domain1').value = '';
    document.getElementById('lt-domain2').value = '';
    document.getElementById('lt-form1').value = '';
    document.getElementById('lt-visit1').value = '';
    document.getElementById('lt-form2').value = '';
    document.getElementById('lt-visit2').value = '';
    document.getElementById('lt-prim-date-col').value = '';
    document.getElementById('lt-rel-date-col').value = '';
    document.getElementById('lt-filter-func').value = 'udf_glbl_filter_by_form_visit';
    document.getElementById('lt-filter-func-custom').value = '';
    document.getElementById('lt-filter-func-custom').classList.add('hidden');
    document.getElementById('lt-null-check-func').value = 'udf_glbl_compare_dates';
    document.getElementById('lt-date-func').value = 'udf_glbl_get_date';
    document.getElementById('lt-comp-func').value = 'udf_glbl_compare_dates';
    document.getElementById('lt-query-func').value = 'udf_glbl_update_querytext';
    document.getElementById('lt-query-func-custom').value = '';
    document.getElementById('lt-query-func-custom').classList.add('hidden');
    document.getElementById('lt-code-output').classList.add('hidden');
    
    clearErrors('lt-');
}

function validateAndGenerateLtCode() {
    if (validateInputs('lt-')) {
        generateLtCode();
    }
}

function generateLtCode() {
    // Get user inputs
    const ruleName = document.getElementById('lt-rule-name').value;
    const domain1 = document.getElementById('lt-domain1').value;
    const domain2 = document.getElementById('lt-domain2').value;
    const form1 = document.getElementById('lt-form1').value;
    const visit1 = processCommaSeparatedInput(document.getElementById('lt-visit1').value);
    const form2 = document.getElementById('lt-form2').value;
    const visit2 = processCommaSeparatedInput(document.getElementById('lt-visit2').value);
    const primDateCol = document.getElementById('lt-prim-date-col').value;
    const relDateCol = document.getElementById('lt-rel-date-col').value;
    
    // Get filter function
    let filterFunc;
    const filterFuncSelect = document.getElementById('lt-filter-func');
    if (filterFuncSelect.value === 'other') {
        filterFunc = document.getElementById('lt-filter-func-custom').value;
    } else {
        filterFunc = filterFuncSelect.value;
    }
    
    // Get query function
    let queryFunc;
    const queryFuncSelect = document.getElementById('lt-query-func');
    if (queryFuncSelect.value === 'other') {
        queryFunc = document.getElementById('lt-query-func-custom').value;
    } else {
        queryFunc = queryFuncSelect.value;
    }
    
    const nullCheckFunc = document.getElementById('lt-null-check-func').value;
    const dateFunc = document.getElementById('lt-date-func').value;
    const compFunc = document.getElementById('lt-comp-func').value;
    
    // Generate the code
    const code = `
"""
Rule Name: ${ruleName}
Domains: ${domain1}, ${domain2}
"""

def ${ruleName}(query_text, ${domain1}, ${domain2}):
    payload_records = []
    prim_df = ${domain1}.copy()
    rel_df = ${domain2}.copy()
    if prim_df.shape[0] > 0:
        args_dict = {
            'p_form_ls': ['${form1}'],
            'p_visit_ls': [${visit1}],
            's_form_ls': ['${form2}'],
            's_visit_ls': [${visit2}],
            'p_var': '${primDateCol}',
            's_var': '${relDateCol}'
        }
        p_form_ls = args_dict['p_form_ls']
        p_visit_ls = args_dict['p_visit_ls']
        s_form_ls = args_dict['s_form_ls']
        s_visit_ls = args_dict['s_visit_ls']
        p_var, s_var = args_dict['p_var'],args_dict['s_var']
        null_values = ['null', 'Null', 'NULL', 'NaN', '', ' ', 'None', 'NaT', 'np.nan', 'nan', None, np.nan]
        prim_df = ${filterFunc}(prim_df,p_form_ls,p_visit_ls)
        rel_df = ${filterFunc}(rel_df,s_form_ls,s_visit_ls)
        if len(prim_df) > 0 and len(rel_df)>0:
            p_flag, prim_df = ${nullCheckFunc}(prim_df, p_var, '!=')
            rel_df = rel_df[(~rel_df['${relDateCol}'].isin(null_values))]
            if len(prim_df) > 0 and len(rel_df)>0:
                prim_df[p_var]=prim_df[p_var].apply(${dateFunc})
                prim_df = prim_df.dropna(subset=[p_var], how='all')
                rel_df[s_var]=rel_df[s_var].apply(${dateFunc})
                rel_df = rel_df.dropna(subset=[s_var], how='all')
                if len(prim_df)>0 and len(rel_df)>0:
                    prim_df = prim_df.sort_values(by='SPID', ascending=True).drop_duplicates(subset=['SUBJID','VISIT',p_var],keep='first').sort_index().reset_index(drop=True)
                    rel_df = rel_df.sort_values(by='SPID', ascending=True).drop_duplicates(subset=['SUBJID','VISIT',s_var],keep='first').sort_index().reset_index(drop=True) 
                    for p_ind in range(prim_df.shape[0]):
                        prim_rec = prim_df.iloc[[p_ind]]
                        n_flag, new_df = ${compFunc}(rel_df, s_var, prim_rec[p_var].values[0],'>')
                        if len(new_df)>0 and n_flag:
                                query_text = ${queryFunc}(query_text)
                                payload = {
                                "query_text":query_text,  # Update the query text here
                                "form_index": str(prim_rec['form_index'].values[0]),
                                "modif_dts": str(pd.to_datetime(prim_rec['modif_dts'].values[0])),
                                "stg_ck_event_id": int(prim_rec['ck_event_id']),
                                "relational_ck_event_ids": [],
                                "confid_score": 1,
                                }
                                payload_records.append(payload)                
    return payload_records
    `;
    
    document.getElementById('lt-code-content').textContent = code;
    document.getElementById('lt-code-output').classList.remove('hidden');
}

function handleCc2FilterFuncChange() {
    const select = document.getElementById('cc2-filter-func');
    const customInput = document.getElementById('cc2-filter-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function handleCc2QueryFuncChange() {
    const select = document.getElementById('cc2-query-func');
    const customInput = document.getElementById('cc2-query-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function clearCc2Inputs() {
    document.getElementById('cc2-rule-name').value = '';
    document.getElementById('cc2-domain').value = '';
    document.getElementById('cc2-form').value = '';
    document.getElementById('cc2-visit').value = '';
    document.getElementById('cc2-term-col').value = 'TERM';
    document.getElementById('cc2-lltcd-col').value = 'LLTCD';
    document.getElementById('cc2-dictv-col').value = 'DICTV';
    document.getElementById('cc2-decod-col').value = 'DECOD';
    document.getElementById('cc2-filter-func').value = 'udf_glbl_filter_by_form_visit';
    document.getElementById('cc2-filter-func-custom').value = '';
    document.getElementById('cc2-filter-func-custom').classList.add('hidden');
    document.getElementById('cc2-query-func').value = 'udf_glbl_update_querytext';
    document.getElementById('cc2-query-func-custom').value = '';
    document.getElementById('cc2-query-func-custom').classList.add('hidden');
    document.getElementById('cc2-code-output').classList.add('hidden');
    
    clearErrors('cc2-');
}

function validateAndGenerateCc2Code() {
    if (validateInputs('cc2-')) {
        generateCc2Code();
    }
}

function generateCc2Code() {
    // Get user inputs
    const ruleName = document.getElementById('cc2-rule-name').value;
    const domain = document.getElementById('cc2-domain').value;
    const form = document.getElementById('cc2-form').value;
    const visit = processCommaSeparatedInput(document.getElementById('cc2-visit').value);
    const termCol = document.getElementById('cc2-term-col').value;
    const lltcdCol = document.getElementById('cc2-lltcd-col').value;
    const dictvCol = document.getElementById('cc2-dictv-col').value;
    const decodCol = document.getElementById('cc2-decod-col').value;
    
    // Get filter function
    let filterFunc;
    const filterFuncSelect = document.getElementById('cc2-filter-func');
    if (filterFuncSelect.value === 'other') {
        filterFunc = document.getElementById('cc2-filter-func-custom').value;
    } else {
        filterFunc = filterFuncSelect.value;
    }
    
    // Get query function
    let queryFunc;
    const queryFuncSelect = document.getElementById('cc2-query-func');
    if (queryFuncSelect.value === 'other') {
        queryFunc = document.getElementById('cc2-query-func-custom').value;
    } else {
        queryFunc = queryFuncSelect.value;
    }
    
    // Generate the code
    const code = `
"""
Rule Name: ${ruleName}
Domain: ${domain}
"""

def ${ruleName}(query_text, ${domain}):
    payload_records = []
    prim_df = ${domain}.copy()
    if prim_df.shape[0] > 0:
        args_dict = {
            'p_form_ls': ['${form}'],
            'p_visit_ls': [${visit}],       
            'logic_text': "((${domain}${termCol} not in @null_values or ${domain}${termCol}.notnull()) and ((${domain}${lltcdCol}.isna() or ${domain}${lltcdCol} in @null_values) or (${domain}${dictvCol}.isna() or ${domain}${dictvCol} in @null_values) or (${domain}${decodCol}.isna() or ${domain}${decodCol} in @null_values))",
            'null_values': ['null', 'Null', 'NULL', 'NaN', '', ' ', 'None', 'NaT', 'np.nan', 'nan', None, np.nan],

        }
        
        p_form_ls = args_dict['p_form_ls']
        p_visit_ls = args_dict['p_visit_ls']
        null_values = args_dict['null_values']
        logic_query = args_dict['logic_text']
        
        prim_df = ${filterFunc}(prim_df,p_form_ls,p_visit_ls)
        if prim_df.shape[0] > 0:
            prim_df = prim_df.query(logic_query)
            if prim_df.shape[0] > 0:
                prim_df = prim_df.sort_values(by='SPID', ascending=True).drop_duplicates(subset=['SUBJID','VISIT','${domain}${termCol}'],keep='first').sort_index().reset_index(drop=True)     
                for prim_ind in prim_df.index.tolist():
                    prim_rec = prim_df.loc[[prim_ind]]
                    query_text = ${queryFunc}(query_text)
                    payload = {
                        "query_text": query_text % (prim_rec['${termCol}'].values[0]),  # Update the query text here
                        "form_index": str(prim_rec['form_index'].values[0]),
                        "modif_dts": str(pd.to_datetime(prim_rec['modif_dts'].values[0])),
                        "stg_ck_event_id": int(prim_rec['ck_event_id']),
                        "relational_ck_event_ids": [],
                        "confid_score": 1,
                        }
                    payload_records.append(payload)
    return payload_records
    `;
    
    document.getElementById('cc2-code-content').textContent = code;
    document.getElementById('cc2-code-output').classList.remove('hidden');
}

function handleSiFilterFuncChange() {
    const select = document.getElementById('si-filter-func');
    const customInput = document.getElementById('si-filter-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function handleSiQueryFuncChange() {
    const select = document.getElementById('si-query-func');
    const customInput = document.getElementById('si-query-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function clearSiInputs() {
    document.getElementById('si-rule-name').value = '';
    document.getElementById('si-domain').value = 'LB';
    document.getElementById('si-lbcat').value = '';
    document.getElementById('si-form').value = '';
    document.getElementById('si-visit').value = '';
    document.getElementById('si-filter-func').value = 'udf_glbl_filter_by_form_visit';
    document.getElementById('si-filter-func-custom').value = '';
    document.getElementById('si-filter-func-custom').classList.add('hidden');
    document.getElementById('si-query-func').value = 'udf_glbl_update_querytext';
    document.getElementById('si-query-func-custom').value = '';
    document.getElementById('si-query-func-custom').classList.add('hidden');
    document.getElementById('si-code-output').classList.add('hidden');
    
    clearErrors('si-');
}

function validateAndGenerateSiCode() {
    if (validateInputs('si-')) {
        generateSiCode();
    }
}

function generateSiCode() {
    // Get user inputs
    const ruleName = document.getElementById('si-rule-name').value;
    const domain = document.getElementById('si-domain').value;
    const lbcat = document.getElementById('si-lbcat').value;
    const form = document.getElementById('si-form').value;
    const visit = processCommaSeparatedInput(document.getElementById('si-visit').value);
    
    // Get filter function
    let filterFunc;
    const filterFuncSelect = document.getElementById('si-filter-func');
    if (filterFuncSelect.value === 'other') {
        filterFunc = document.getElementById('si-filter-func-custom').value;
    } else {
        filterFunc = filterFuncSelect.value;
    }
    
    // Get query function
    let queryFunc;
    const queryFuncSelect = document.getElementById('si-query-func');
    if (queryFuncSelect.value === 'other') {
        queryFunc = document.getElementById('si-query-func-custom').value;
    } else {
        queryFunc = queryFuncSelect.value;
    }
    
    // Generate the code
    const code = `
"""
Rule Name: ${ruleName}
Domains: ${domain}
"""

def ${ruleName}(query_text, ${domain}):
    prim_df = ${domain}.copy()    
    payload_records = []
    if prim_df.shape[0] > 0:
        args_dict ={
            'logic_text': "((LBCAT.str.upper() == '${lbcat.toUpperCase()}') and (LBTESTCD not in @null_values and ~(LBTESTCD.isna())) and (LBORRESU not in @null_values and ~(LBORRESU.isna())) and (LBSTAT.isna() or LBSTAT in @null_values) and (LBSTRESU.isna() or LBSTRESU in @null_values))",
            'null_values': ['', ' ', None, np.nan],
        }
        null_values = args_dict['null_values']
        logic_query = args_dict['logic_text']
        prim_df = ${filterFunc}(prim_df, ['${form}'], [${visit}])
        if len(prim_df)>0:
            prim_df = prim_df.query(logic_query)
            if len(prim_df) > 0:
                prim_df = prim_df.sort_values(by='SPID', ascending=True).drop_duplicates(subset=['SUBJID','VISIT','LBTEST','LBORRESU'],keep='first').sort_index().reset_index(drop=True)
                for prim_ind in prim_df.index.tolist():
                    prim_rec = prim_df.loc[[prim_ind]]
                    query_text = ${queryFunc}(query_text)
                    payload = {
                        "query_text": query_text % (prim_rec['LBTEST'].values[0]), #Update the query text here
                        "form_index": str(prim_rec['form_index'].values[0]),
                        "modif_dts": str(pd.to_datetime(prim_rec['modif_dts'].values[0])),
                        "stg_ck_event_id": int(prim_rec['ck_event_id']),
                        "relational_ck_event_ids": [],
                        "confid_score": 1,
                        } 
                    payload_records.append(payload)
    return payload_records
    `;
    
    document.getElementById('si-code-content').textContent = code;
    document.getElementById('si-code-output').classList.remove('hidden');
}

function handleUsFilterFuncChange() {
    const select = document.getElementById('us-filter-func');
    const customInput = document.getElementById('us-filter-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function handleUsQueryFuncChange() {
    const select = document.getElementById('us-query-func');
    const customInput = document.getElementById('us-query-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function clearUsInputs() {
    document.getElementById('us-rule-name').value = '';
    document.getElementById('us-domain').value = 'LB';
    document.getElementById('us-lbcat').value = '';
    document.getElementById('us-form').value = '';
    document.getElementById('us-visit').value = '';
    document.getElementById('us-filter-func').value = 'udf_glbl_filter_by_form_visit';
    document.getElementById('us-filter-func-custom').value = '';
    document.getElementById('us-filter-func-custom').classList.add('hidden');
    document.getElementById('us-query-func').value = 'udf_glbl_update_querytext';
    document.getElementById('us-query-func-custom').value = '';
    document.getElementById('us-query-func-custom').classList.add('hidden');
    document.getElementById('us-code-output').classList.add('hidden');
    
    clearErrors('us-');
}

function validateAndGenerateUsCode() {
    if (validateInputs('us-')) {
        generateUsCode();
    }
}

function generateUsCode() {
    // Get user inputs
    const ruleName = document.getElementById('us-rule-name').value;
    const domain = document.getElementById('us-domain').value;
    const lbcat = document.getElementById('us-lbcat').value;
    const form = document.getElementById('us-form').value;
    const visit = processCommaSeparatedInput(document.getElementById('us-visit').value);
    
    // Get filter function
    let filterFunc;
    const filterFuncSelect = document.getElementById('us-filter-func');
    if (filterFuncSelect.value === 'other') {
        filterFunc = document.getElementById('us-filter-func-custom').value;
    } else {
        filterFunc = filterFuncSelect.value;
    }
    
    // Get query function
    let queryFunc;
    const queryFuncSelect = document.getElementById('us-query-func');
    if (queryFuncSelect.value === 'other') {
        queryFunc = document.getElementById('us-query-func-custom').value;
    } else {
        queryFunc = queryFuncSelect.value;
    }
    
    // Generate the code
    const code = `
"""
Rule Name: ${ruleName}
Domains: ${domain}
"""

def ${ruleName}(query_text, ${domain}):
    prim_df = ${domain}.copy()    
    payload_records = []
    if prim_df.shape[0] > 0:
        args_dict ={
            'logic_text': "((LBCAT.str.upper() == '${lbcat.toUpperCase()}') and (LBTESTCD not in @null_values and ~(LBTESTCD.isna())) and (LBORRESU not in @null_values and ~(LBORRESU.isna())) and (LBSTAT.isna() or LBSTAT in @null_values) and (XLSTRESU.isna() or XLSTRESU in @null_values))",
            'null_values': ['', ' ', None, np.nan],
        }
        null_values = args_dict['null_values']
        logic_query = args_dict['logic_text']
        prim_df = ${filterFunc}(prim_df, ['${form}'], [${visit}])
        if len(prim_df)>0:
            prim_df = prim_df.query(logic_query)
            if len(prim_df) > 0:
                for prim_ind in prim_df.index.tolist():
                    prim_rec = prim_df.loc[[prim_ind]]
                    query_text = ${queryFunc}(query_text)
                    payload = {
                        "query_text": query_text % (prim_rec['LBTEST'].values[0]), #Update the query text here
                        "form_index": str(prim_rec['form_index'].values[0]),
                        "modif_dts": str(pd.to_datetime(prim_rec['modif_dts'].values[0])),
                        "stg_ck_event_id": int(prim_rec['ck_event_id']),
                        "relational_ck_event_ids": [],
                        "confid_score": 1,
                        } 
                    payload_records.append(payload)
    return payload_records
    `;
    
    document.getElementById('us-code-content').textContent = code;
    document.getElementById('us-code-output').classList.remove('hidden');
}

function handleUsNumericFilterFuncChange() {
    const select = document.getElementById('us-numeric-filter-func');
    const customInput = document.getElementById('us-numeric-filter-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function handleUsNumericQueryFuncChange() {
    const select = document.getElementById('us-numeric-query-func');
    const customInput = document.getElementById('us-numeric-query-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function clearUsNumericInputs() {
    document.getElementById('us-numeric-rule-name').value = '';
    document.getElementById('us-numeric-domain').value = 'LB';
    document.getElementById('us-numeric-lbcat').value = '';
    document.getElementById('us-numeric-form').value = '';
    document.getElementById('us-numeric-visit').value = '';
    document.getElementById('us-numeric-filter-func').value = 'udf_glbl_filter_by_form_visit';
    document.getElementById('us-numeric-filter-func-custom').value = '';
    document.getElementById('us-numeric-filter-func-custom').classList.add('hidden');
    document.getElementById('us-numeric-query-func').value = 'udf_glbl_update_querytext';
    document.getElementById('us-numeric-query-func-custom').value = '';
    document.getElementById('us-numeric-query-func-custom').classList.add('hidden');
    document.getElementById('us-numeric-code-output').classList.add('hidden');
    
    clearErrors('us-numeric-');
}

function validateAndGenerateUsNumericCode() {
    if (validateInputs('us-numeric-')) {
        generateUsNumericCode();
    }
}

function generateUsNumericCode() {
    // Get user inputs
    const ruleName = document.getElementById('us-numeric-rule-name').value;
    const domain = document.getElementById('us-numeric-domain').value;
    const lbcat = document.getElementById('us-numeric-lbcat').value;
    const form = document.getElementById('us-numeric-form').value;
    const visit = processCommaSeparatedInput(document.getElementById('us-numeric-visit').value);
    
    // Get filter function
    let filterFunc;
    const filterFuncSelect = document.getElementById('us-numeric-filter-func');
    if (filterFuncSelect.value === 'other') {
        filterFunc = document.getElementById('us-numeric-filter-func-custom').value;
    } else {
        filterFunc = filterFuncSelect.value;
    }
    
    // Get query function
    let queryFunc;
    const queryFuncSelect = document.getElementById('us-numeric-query-func');
    if (queryFuncSelect.value === 'other') {
        queryFunc = document.getElementById('us-numeric-query-func-custom').value;
    } else {
        queryFunc = queryFuncSelect.value;
    }
    
    // Generate the code
    const code = `
"""
Rule Name: ${ruleName}
Domains: ${domain}
"""

def ${ruleName}(query_text, ${domain}):
    payload_records = []
    prim_df = ${domain}.copy()    
    if prim_df.shape[0] > 0:
        args_dict = {
            'logic_text': "(LBCAT.str.upper() == '${lbcat.toUpperCase()}') and (LBTESTCD not in @null_values and ~(LBTESTCD.isna())) and (LBORRESN not in @null_values and ~(LBORRESN.isna())) and (LBORRESU not in @null_values and ~(LBORRESU.isna())) and (XLSTRESU.isna() or XLSTRESU in @null_values) and (XLSTRESN.isna() or XLSTRESN in @null_values)",
            'null_values': ['', ' ', None, np.nan],
        }
        null_values = args_dict['null_values']
        logic_query = args_dict['logic_text']
        prim_df = ${filterFunc}(prim_df, ['${form}'], [${visit}])
        if len(prim_df) > 0:
            prim_df = prim_df.query(logic_query)
            if len(prim_df) > 0:
                prim_df = prim_df.sort_values(by='SPID', ascending=True).drop_duplicates(subset=['SUBJID','VISIT','LBTEST','LBORRESU'],keep='first').sort_index().reset_index(drop=True)
                for prim_ind in prim_df.index.tolist():
                    prim_rec = prim_df.loc[[prim_ind]]
                    query_text = ${queryFunc}(query_text)
                    payload = {
                        "query_text": query_text % (prim_rec['LBTEST'].values[0], prim_rec['LBORRESU'].values[0]),  # Update the query text here
                        "form_index": str(prim_rec['form_index'].values[0]),
                        "modif_dts": str(pd.to_datetime(prim_rec['modif_dts'].values[0])),
                        "stg_ck_event_id": int(prim_rec['ck_event_id']),
                        "confid_score": 1,
                        }
                    payload_records.append(payload)
    return payload_records
    `;
    
    document.getElementById('us-numeric-code-content').textContent = code;
    document.getElementById('us-numeric-code-output').classList.remove('hidden');
}

function handleSiNumericFilterFuncChange() {
    const select = document.getElementById('si-numeric-filter-func');
    const customInput = document.getElementById('si-numeric-filter-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function handleSiNumericQueryFuncChange() {
    const select = document.getElementById('si-numeric-query-func');
    const customInput = document.getElementById('si-numeric-query-func-custom');
    
    if (select.value === 'other') {
        customInput.classList.remove('hidden');
        customInput.value = '';
        customInput.required = true;
    } else {
        customInput.classList.add('hidden');
        customInput.required = false;
    }
}

function clearSiNumericInputs() {
    document.getElementById('si-numeric-rule-name').value = '';
    document.getElementById('si-numeric-domain').value = 'LB';
    document.getElementById('si-numeric-lbcat').value = '';
    document.getElementById('si-numeric-form').value = '';
    document.getElementById('si-numeric-visit').value = '';
    document.getElementById('si-numeric-filter-func').value = 'udf_glbl_filter_by_form_visit';
    document.getElementById('si-numeric-filter-func-custom').value = '';
    document.getElementById('si-numeric-filter-func-custom').classList.add('hidden');
    document.getElementById('si-numeric-query-func').value = 'udf_glbl_update_querytext';
    document.getElementById('si-numeric-query-func-custom').value = '';
    document.getElementById('si-numeric-query-func-custom').classList.add('hidden');
    document.getElementById('si-numeric-code-output').classList.add('hidden');
    
    clearErrors('si-numeric-');
}

function validateAndGenerateSiNumericCode() {
    if (validateInputs('si-numeric-')) {
        generateSiNumericCode();
    }
}

function generateSiNumericCode() {
    // Get user inputs
    const ruleName = document.getElementById('si-numeric-rule-name').value;
    const domain = document.getElementById('si-numeric-domain').value;
    const lbcat = document.getElementById('si-numeric-lbcat').value;
    const form = document.getElementById('si-numeric-form').value;
    const visit = processCommaSeparatedInput(document.getElementById('si-numeric-visit').value);
    
    // Get filter function
    let filterFunc;
    const filterFuncSelect = document.getElementById('si-numeric-filter-func');
    if (filterFuncSelect.value === 'other') {
        filterFunc = document.getElementById('si-numeric-filter-func-custom').value;
    } else {
        filterFunc = filterFuncSelect.value;
    }
    
    // Get query function
    let queryFunc;
    const queryFuncSelect = document.getElementById('si-numeric-query-func');
    if (queryFuncSelect.value === 'other') {
        queryFunc = document.getElementById('si-numeric-query-func-custom').value;
    } else {
        queryFunc = queryFuncSelect.value;
    }
    
    // Generate the code
    const code = `
"""
Rule Name: ${ruleName}
Domains: ${domain}
"""

def ${ruleName}(query_text, ${domain}):
    payload_records = []
    prim_df = ${domain}.copy()    
    if prim_df.shape[0] > 0:
        args_dict = {
            'logic_text': "(LBCAT.str.upper() == '${lbcat.toUpperCase()}') and (LBTESTCD not in @null_values and ~(LBTESTCD.isna())) and (LBORRESN not in @null_values and ~(LBORRESN.isna())) and (LBORRESU not in @null_values and ~(LBORRESU.isna())) and (LBSTRESU.isna() or LBSTRESU in @null_values) and (LBSTRESN.isna() or LBSTRESN in @null_values)",
            'null_values': ['', ' ', None, np.nan],
        }
        null_values = args_dict['null_values']
        logic_query = args_dict['logic_text']
        prim_df = ${filterFunc}(prim_df, ['${form}'], [${visit}])
        if len(prim_df) > 0:
            prim_df = prim_df.query(logic_query)
            if len(prim_df) > 0:
                prim_df = prim_df.sort_values(by='SPID', ascending=True).drop_duplicates(subset=['SUBJID','VISIT','LBTEST','LBORRESU'],keep='first').sort_index().reset_index(drop=True)
                for prim_ind in prim_df.index.tolist():
                    prim_rec = prim_df.loc[[prim_ind]]
                    query_text = ${queryFunc}(query_text)
                    payload = {
                        "query_text": query_text %(prim_rec['LBTEST'].values[0],prim_rec['LBORRESU'].values[0]),  # Update the query text here
                        "form_index": str(prim_rec['form_index'].values[0]),
                        "modif_dts": str(pd.to_datetime(prim_rec['modif_dts'].values[0])),
                        "stg_ck_event_id": int(prim_rec['ck_event_id']),
                        "confid_score": 1,
                        }
                    payload_records.append(payload)
    return payload_records
    `;
    
    document.getElementById('si-numeric-code-content').textContent = code;
    document.getElementById('si-numeric-code-output').classList.remove('hidden');
}
        
        // Search functionality
        function setupSearch() {
            const searchBox = document.getElementById('search-box');
            const searchResults = document.getElementById('search-results');
            
            searchBox.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                
                if (searchTerm.length === 0) {
                    searchResults.classList.remove('show');
                    return;
                }
                
                // Filter search data
                const results = searchData.filter(item => 
                    item.title.toLowerCase().includes(searchTerm) || 
                    item.description.toLowerCase().includes(searchTerm) ||
                    item.category.toLowerCase().includes(searchTerm)
                );
                
                // Display results
                if (results.length > 0) {
                    searchResults.innerHTML = results.map(item => `
                        <div class="search-result-item" onclick="showGenerator('${item.id}')">
                            <h4>${item.title}</h4>
                            <p>${item.description}</p>
                            <div class="search-result-category">${item.category}</div>
                        </div>
                    `).join('');
                    searchResults.classList.add('show');
                } else {
                    searchResults.innerHTML = '<div class="search-result-item">No results found</div>';
                    searchResults.classList.add('show');
                }
            });
            
            // Close search results when clicking outside
            document.addEventListener('click', function(e) {
                if (!searchBox.contains(e.target) && !searchResults.contains(e.target)) {
                    searchResults.classList.remove('show');
                }
            });
        }
        
        // Initialize the page with welcome content
        document.addEventListener('DOMContentLoaded', function() {
        // Show welcome page by default
        document.getElementById('welcome-page').classList.remove('hidden');
        
        // Hide all generators
        const generators = document.querySelectorAll('.generator-container');
        generators.forEach(gen => gen.classList.add('hidden'));
        
        // Setup search functionality
                setupSearch();
        });
    </script>
</body>
</html>